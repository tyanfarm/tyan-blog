"use strict";(self.webpackChunktyan_blog=self.webpackChunktyan_blog||[]).push([[885],{3457:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>o,contentTitle:()=>h,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"build-llm-from-scratch/attention-mechanisms-04","title":"3. Coding Attention Mechanisms (Part 04)","description":"3.5. Che \u0111i (mask) c\xe1c t\u1eeb ph\xeda sau v\u1edbi c\u01a1 ch\u1ebf causal attention","source":"@site/docs/build-llm-from-scratch/attention-mechanisms-04.md","sourceDirName":"build-llm-from-scratch","slug":"/build-llm-from-scratch/attention-mechanisms-04","permalink":"/tyan-blog/docs/build-llm-from-scratch/attention-mechanisms-04","draft":false,"unlisted":false,"editUrl":"https://github.com/tyanfarm/tyan-blog/tree/main/docs/build-llm-from-scratch/attention-mechanisms-04.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"3. Coding Attention Mechanisms (Part 04)"},"sidebar":"tutorialSidebar","previous":{"title":"3. Coding Attention Mechanisms (Part 03)","permalink":"/tyan-blog/docs/build-llm-from-scratch/attention-mechanisms-03"},"next":{"title":"Normalization","permalink":"/tyan-blog/docs/build-llm-from-scratch/bonus-section/normalization"}}');var s=e(4848),c=e(8453);const a={sidebar_position:6,title:"3. Coding Attention Mechanisms (Part 04)"},h=void 0,o={},l=[{value:"3.5. Che \u0111i (mask) c\xe1c t\u1eeb ph\xeda sau v\u1edbi c\u01a1 ch\u1ebf causal attention",id:"35-che-\u0111i-mask-c\xe1c-t\u1eeb-ph\xeda-sau-v\u1edbi-c\u01a1-ch\u1ebf-causal-attention",level:2},{value:"Mask th\xeam c\xe1c attention weights v\u1edbi dropout",id:"mask-th\xeam-c\xe1c-attention-weights-v\u1edbi-dropout",level:4}];function r(n){const t={a:"a",annotation:"annotation",code:"code",em:"em",h2:"h2",h4:"h4",img:"img",li:"li",math:"math",mo:"mo",mrow:"mrow",p:"p",semantics:"semantics",span:"span",ul:"ul",...(0,c.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"35-che-\u0111i-mask-c\xe1c-t\u1eeb-ph\xeda-sau-v\u1edbi-c\u01a1-ch\u1ebf-causal-attention",children:"3.5. Che \u0111i (mask) c\xe1c t\u1eeb ph\xeda sau v\u1edbi c\u01a1 ch\u1ebf causal attention"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["\u1ede ph\u1ea7n n\xe0y, ta s\u1ebd bi\u1ebfn \u0111\u1ed5i c\u01a1 ch\u1ebf ",(0,s.jsx)(t.code,{children:"self-attention"})," ti\xeau chu\u1ea9n \u0111\u1ec3 t\u1ea1o ra c\u01a1 ch\u1ebf ",(0,s.jsx)(t.code,{children:"causal attention"})," - m\u1ed9t th\xe0nh ph\u1ea7n c\u1ed1t l\xf5i c\u1ee7a Transformer."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.em,{children:"Causal attention"}),", c\xf2n g\u1ecdi l\xe0 ",(0,s.jsx)(t.em,{children:"masked attention"}),", l\xe0 m\u1ed9t d\u1ea1ng chuy\xean bi\u1ec7t c\u1ee7a ",(0,s.jsx)(t.em,{children:"self-attention"}),'. C\u01a1 ch\u1ebf n\xe0y gi\u1edbi h\u1ea1n m\xf4 h\xecnh ch\u1ec9 \u0111\u01b0\u1ee3c "nh\xecn th\u1ea5y" ',(0,s.jsx)(t.em,{children:"c\xe1c token \u0111\u1ea7u v\xe0o tr\u01b0\u1edbc \u0111\xf3 v\xe0 hi\u1ec7n t\u1ea1i"})," khi x\u1eed l\xed b\u1ea5t k\xec token n\xe0o. \u0110i\u1ec1u n\xe0y tr\xe1i ng\u01b0\u1ee3c v\u1edbi c\u01a1 ch\u1ebf ",(0,s.jsx)(t.em,{children:"self-attention"}),' ti\xeau chu\u1ea9n, v\u1ed1n cho ph\xe9p "nh\xecn th\u1ea5y" to\xe0n b\u1ed9 chu\u1ed7i ',(0,s.jsx)(t.em,{children:"c\xe1c token \u0111\u1ea7u v\xe0o"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Do \u0111\xf3, khi t\xednh to\xe1n ",(0,s.jsx)(t.code,{children:"attention scores"}),", ",(0,s.jsx)(t.em,{children:"causal attention"})," \u0111\u1ea3m b\u1ea3o m\xf4 h\xecnh ch\u1ec9 t\xednh \u0111\u1ebfn c\xe1c token xu\u1ea5t hi\u1ec7n ",(0,s.jsx)(t.code,{children:"t\u1ea1i ho\u1eb7c tr\u01b0\u1edbc"})," token hi\u1ec7n t\u1ea1i trong chu\u1ed7i."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["\u1ede h\xecnh ph\xeda d\u01b0\u1edbi, c\u01a1 ch\u1ebf ",(0,s.jsx)(t.code,{children:"causal attention"})," che (mask) c\xe1c ",(0,s.jsx)(t.em,{children:"attention weights"})," \u1edf ",(0,s.jsx)(t.em,{children:"ph\xeda tr\xean \u0111\u01b0\u1eddng ch\xe9o ch\xednh"}),". \u0110i\u1ec1u n\xe0y \u0111\u1ea3m b\u1ea3o v\u1edbi 1 \u0111\u1ea7u v\xe0o \u0111\xe3 cho, LLM kh\xf4ng th\u1ec3 l\u1ea5y c\xe1c token t\u01b0\u01a1ng lai khi t\xednh to\xe1n c\xe1c ",(0,s.jsx)(t.code,{children:"context vectors"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt",src:e(2444).A+"",width:"936",height:"456"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Theo d\xf5i code minh h\u1ecda t\u1ea1i - Theo d\xf5i code minh h\u1ecda t\u1ea1i ",(0,s.jsx)(t.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/9.%20Causal-attention.ipynb",children:(0,s.jsx)(t.code,{children:"9. Causal-attention.ipynb"})}),"."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Version 01:"}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt",src:e(9585).A+"",width:"1043",height:"300"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Version 02:"}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt",src:e(3905).A+"",width:"882",height:"242"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h4,{id:"mask-th\xeam-c\xe1c-attention-weights-v\u1edbi-dropout",children:"Mask th\xeam c\xe1c attention weights v\u1edbi dropout"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["N\u1ebfu ",(0,s.jsx)(t.code,{children:"casual mask"}),' l\xe0 \u0111\u1ec3 ng\u0103n m\xf4 h\xecnh \u0103n gian trong qu\xe1 tr\xecnh h\u1ecdc khi "nh\xecn" c\xe1c ',(0,s.jsx)(t.em,{children:"future token"}),", th\xec ",(0,s.jsx)(t.code,{children:"dropout"})," l\xe0 \u0111\u1ec3 tr\xe1nh m\xf4 h\xecnh ",(0,s.jsx)(t.em,{children:"overfitting"})," v\xe0o m\u1ed9t t\u1eadp \u0111\u01a1n v\u1ecb n\xe0o \u0111\xf3 trong hidden layer. L\u01b0u \xfd r\u1eb1ng ",(0,s.jsx)(t.em,{children:"dropout"})," ch\u1ec9 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong qu\xe1 tr\xecnh ",(0,s.jsx)(t.em,{children:"training"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsxs)(t.span,{className:"katex",children:[(0,s.jsx)(t.span,{className:"katex-mathml",children:(0,s.jsx)(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(t.semantics,{children:[(0,s.jsx)(t.mrow,{children:(0,s.jsx)(t.mo,{children:"\u2192"})}),(0,s.jsx)(t.annotation,{encoding:"application/x-tex",children:"\\rightarrow"})]})})}),(0,s.jsx)(t.span,{className:"katex-html","aria-hidden":"true",children:(0,s.jsxs)(t.span,{className:"base",children:[(0,s.jsx)(t.span,{className:"strut",style:{height:"0.3669em"}}),(0,s.jsx)(t.span,{className:"mrel",children:"\u2192"})]})})]})," M\u1ee5c ti\xeau: ",(0,s.jsx)(t.code,{children:"Ch\u1ed1ng overfitting"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt",src:e(4030).A+"",width:"741",height:"656"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["\u0110\u01b0\u1ee3c minh h\u1ecda \u1edf h\xecnh tr\xean, sau khi s\u1eed d\u1ee5ng ",(0,s.jsx)(t.code,{children:"causal mask"}),", ta th\xeam 1 ",(0,s.jsx)(t.code,{children:"dropout mask"})," \u0111\u1ec3 g\xe1n ",(0,s.jsx)(t.em,{children:"gi\xe1 tr\u1ecb 0"})," m\u1ed9t c\xe1ch ng\u1eabu nhi\xean nh\u1eb1m gi\u1ea3m ",(0,s.jsx)(t.em,{children:"overfitting"})," trong qu\xe1 tr\xecnh ",(0,s.jsx)(t.em,{children:"training"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt",src:e(3230).A+"",width:"1053",height:"301"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["\u1ede ph\u1ea7n n\xe0y ta \u0111\xe3 t\xecm hi\u1ec3u v\u1ec1 c\u01a1 ch\u1ebf ho\u1ea1t \u0111\u1ed9ng v\xe0 tri\u1ec3n khai code c\u1ee7a ",(0,s.jsx)(t.code,{children:"causal attention"}),". \u1ede ph\u1ea7n sau ta s\u1ebd m\u1edf r\u1ed9ng th\xeam v\xe0 tri\u1ec3n khai c\u01a1 ch\u1ebf ",(0,s.jsx)(t.code,{children:"multi-head attention"})," \u0111\u1ec3 tri\u1ec3n khai ",(0,s.jsx)(t.em,{children:"c\u01a1 ch\u1ebf causal attention"})," song song."]}),"\n"]}),"\n"]})]})}function d(n={}){const{wrapper:t}={...(0,c.R)(),...n.components};return t?(0,s.jsx)(t,{...n,children:(0,s.jsx)(r,{...n})}):r(n)}},2444:(n,t,e)=>{e.d(t,{A:()=>i});const i=e.p+"assets/images/attention_14_causal_attention_scores-ee9fd8cd81ebac171392121bed33d031.png"},9585:(n,t,e)=>{e.d(t,{A:()=>i});const i=e.p+"assets/images/attention_15_causal_ver1-a5d0883a9cb94e27eb72eef1ad4fa151.png"},3905:(n,t,e)=>{e.d(t,{A:()=>i});const i=e.p+"assets/images/attention_16_causal_ver2-90b41a35281d5c3702339cead054288f.png"},4030:(n,t,e)=>{e.d(t,{A:()=>i});const i=e.p+"assets/images/attention_17_causal_dropout-0a27cd8dfe87dc4e4de9d3f30bf701b6.png"},3230:(n,t,e)=>{e.d(t,{A:()=>i});const i=e.p+"assets/images/attention_18_causal_final-60f534c6a5910900d757100ee80ca75a.png"},8453:(n,t,e)=>{e.d(t,{R:()=>a,x:()=>h});var i=e(6540);const s={},c=i.createContext(s);function a(n){const t=i.useContext(c);return i.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function h(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),i.createElement(c.Provider,{value:t},n.children)}}}]);