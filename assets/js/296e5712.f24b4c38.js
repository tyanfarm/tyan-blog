"use strict";(self.webpackChunktyan_blog=self.webpackChunktyan_blog||[]).push([[490],{951:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>o,frontMatter:()=>h,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"build-llm-from-scratch/data-preparation-and-sampling","title":"2. Data Preparation and Sampling","description":"Word Embeddings","source":"@site/docs/build-llm-from-scratch/data-preparation-and-sampling.md","sourceDirName":"build-llm-from-scratch","slug":"/build-llm-from-scratch/data-preparation-and-sampling","permalink":"/tyan-blog/docs/build-llm-from-scratch/data-preparation-and-sampling","draft":false,"unlisted":false,"editUrl":"https://github.com/tyanfarm/tyan-blog/tree/main/docs/build-llm-from-scratch/data-preparation-and-sampling.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"2. Data Preparation and Sampling"},"sidebar":"tutorialSidebar","previous":{"title":"1. State of building LLMs","permalink":"/tyan-blog/docs/build-llm-from-scratch/state-of-building-LLMs"},"next":{"title":"3. Coding Attention Mechanisms (Part 01)","permalink":"/tyan-blog/docs/build-llm-from-scratch/attention-mechanisms-01"}}');var c=s(4848),t=s(8453);const h={sidebar_position:2,title:"2. Data Preparation and Sampling"},l=void 0,d={},a=[{value:"Word Embeddings",id:"word-embeddings",level:2},{value:"Tokenizing text",id:"tokenizing-text",level:2},{value:"Converting tokens into token IDs",id:"converting-tokens-into-token-ids",level:2},{value:"Implementing a simple text tokenizer",id:"implementing-a-simple-text-tokenizer",level:4},{value:"Adding special context tokens",id:"adding-special-context-tokens",level:2},{value:"Byte Pair Encoding",id:"byte-pair-encoding",level:2},{value:"Data sampling with a sliding window",id:"data-sampling-with-a-sliding-window",level:2},{value:"Creating Token Embeddings",id:"creating-token-embeddings",level:2},{value:"Embedding Layer v\xe0 Matrix Multiplication (Nh\xe2n ma tr\u1eadn)",id:"embedding-layer-v\xe0-matrix-multiplication-nh\xe2n-ma-tr\u1eadn",level:3},{value:"Encoding Word Positions",id:"encoding-word-positions",level:2}];function r(n){const e={a:"a",annotation:"annotation",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",math:"math",mi:"mi",mo:"mo",mrow:"mrow",munder:"munder",p:"p",pre:"pre",semantics:"semantics",span:"span",ul:"ul",...(0,t.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h2,{id:"word-embeddings",children:"Word Embeddings"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["C\xe1c m\xf4 h\xecnh m\u1ea1ng n\u01a1 ron h\u1ecdc s\xe2u (Deep neural network models), bao g\u1ed3m c\u1ea3 LLMs, kh\xf4ng th\u1ec3 x\u1eed l\xed tr\u1ef1c ti\u1ebfp ",(0,c.jsx)(e.code,{children:"v\u0103n b\u1ea3n th\xf4"}),". Do \u0111\xf3, ta c\u1ea7n m\u1ed9t c\xe1ch \u0111\u1ec3 bi\u1ec3u di\u1ec5n c\xe1c t\u1eeb th\xe0nh ",(0,c.jsx)(e.em,{children:"c\xe1c vector c\xf3 gi\xe1 tr\u1ecb li\xean t\u1ee5c"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Kh\xe1i ni\u1ec7m n\xe0y \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ",(0,c.jsx)(e.code,{children:"embedding"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"Word Embedding c\xf3 th\u1ec3 c\xf3 s\u1ed1 chi\u1ec1u kh\xe1c nhau, t\u1eeb 1 \u0111\u1ebfn h\xe0ng ngh\xecn."}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(946).A+"",width:"1421",height:"722"})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Trong khi ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng c\xe1c pretrained model nh\u01b0 ",(0,c.jsx)(e.code,{children:"Word2Vec"})," \u0111\u1ec3 t\u1ea1o embedding cho c\xe1c m\xf4 h\xecnh m\xe1y h\u1ecdc, th\xec ",(0,c.jsx)(e.code,{children:"LLM"})," t\u1ef1 sinh ra embedding ri\xeang \u1edf ",(0,c.jsx)(e.em,{children:"input layer"})," v\xe0 c\xe1c embedding \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt trong qu\xe1 tr\xecnh hu\u1ea5n luy\u1ec7n."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["H\u01a1n n\u1eefa, ",(0,c.jsx)(e.code,{children:"LLM"})," c\xf2n c\xf3 kh\u1ea3 n\u0103ng t\u1ea1o ra c\xe1c embedding gi\xe0u ng\u1eef c\u1ea3nh (",(0,c.jsx)(e.code,{children:"contextual embedding"}),"), s\u1ebd \u0111\u01b0\u1ee3c th\u1ea3o lu\u1eadn \u1edf ph\u1ea7n 3. C\xe1c ph\u1ea7n ti\u1ebfp theo trong ph\u1ea7n n\xe0y bao g\u1ed3m: ",(0,c.jsx)(e.em,{children:"splitting text into words"}),", ",(0,c.jsx)(e.em,{children:"converting words into tokens"})," & ",(0,c.jsx)(e.em,{children:"turning tokens into embedding vectors"})]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"tokenizing-text",children:"Tokenizing text"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(2903).A+"",width:"1503",height:"1016"})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["B\u1eaft \u0111\u1ea7u v\u1edbi v\xe0i m\u1eabu text, ta c\xf3 th\u1ec3 d\xf9ng ",(0,c.jsx)(e.code,{children:"re.split"})," \u0111\u1ec3 split theo kho\u1ea3ng tr\u1eafng nh\u01b0 sau:"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"import re\r\ntext = \"Hello, world. This, is a test.\"\r\nresult = re.split(r'(\\s)', text)\r\nprint(result)\n"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"K\u1ebft qu\u1ea3 s\u1ebd l\xe0 1 list c\xe1c t\u1eeb v\xe0 k\xed t\u1ef1 sau:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"['Hello,', ' ', 'world.', ' ', 'This,', ' ', 'is', ' ', 'a', ' ', 'test.']\n"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"Tuy nhi\xean, v\u1eabn c\xf2n 1 v\xe0i t\u1eeb d\xednh v\u1edbi c\xe1c k\xed t\u1ef1 d\u1ea5u c\xe2u, ta s\u1ebd t\xe1ch ra th\xe0nh c\xe1c ph\u1ea7n t\u1eed ri\xeang:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"result = re.split(r'([,.]|\\s)', text)\r\nprint(result)\n"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"\u0110\xe2y l\xe0 k\u1ebft qu\u1ea3:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"['Hello', ',', '', ' ', 'world', '.', '', ' ', 'This', ',', '', ' ', 'is', ' ', 'a', ' ', 'test', '.']\n"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["V\u1ec1 c\xe1c ",(0,c.jsx)(e.em,{children:"whitespaces"}),", c\u1ea7n gi\u1eef hay lo\u1ea1i b\u1ecf? Lo\u1ea1i b\u1ecf s\u1ebd gi\xfap gi\u1ea3m nhu c\u1ea7u v\u1ec1 b\u1ed9 nh\u1edb & t\xednh to\xe1n. Tuy nhi\xean, gi\u1eef l\u1ea1i c\xf3 th\u1ec3 h\u1eefu \xedch n\u1ebfu hu\u1ea5n luy\u1ec7n c\xe1c m\xf4 h\xecnh nh\u1ea1y c\u1ea3m v\u1edbi c\u1ea5u tr\xfac ch\xednh x\xe1c (v\xed d\u1ee5: m\xe3 Python nh\u1ea1y c\u1ea3m v\u1edbi c\xe1c kho\u1ea3ng ",(0,c.jsx)(e.em,{children:"\\tab"}),")."]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"result = [item for item in result if item.strip()]\r\nprint(result)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"['Hello', ',', 'world', '.', 'This', ',', 'is', 'a', 'test', '.']\n"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Ph\u01b0\u01a1ng ph\xe1p ",(0,c.jsx)(e.em,{children:"tokenize"})," tr\xean hi\u1ec7u qu\u1ea3 v\u1edbi c\xe1c \u0111o\u1ea1n text \u0111\u01a1n gi\u1ea3n. Ta s\u1ebd \u0111i\u1ec1u ch\u1ec9nh th\xeam \u0111\u1ec3 n\xf3 c\xf3 th\u1ec3 x\u1eed l\xfd \u0111\u01b0\u1ee3c nhi\u1ec1u lo\u1ea1i d\u1ea5u c\xe2u kh\xe1c (",(0,c.jsx)(e.code,{children:"?, !, ;, ..."}),"):"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"text = \"Hello, world. Is this-- a test?\"\r\nresult = re.split(r'([,.:;?_!\"()\\']|--|\\s)', text)\r\nresult = [item.strip() for item in result if item.strip()]\r\nprint(result)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"['Hello', ',', 'world', '.', 'Is', 'this', '--', 'a', 'test', '?']\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(9825).A+"",width:"999",height:"327"})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"converting-tokens-into-token-ids",children:"Converting tokens into token IDs"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["\u0110\u1ec3 \xe1nh x\u1ea1 c\xe1c tokens tr\u01b0\u1edbc \u0111\xf3 th\xe0nh c\xe1c token IDs, tr\u01b0\u1edbc ti\xean ch\xfang ta c\u1ea7n t\u1ea1o ",(0,c.jsx)(e.code,{children:"vocabulary"}),", c\u1ee5 th\u1ec3 \u0111\u01b0\u1ee3c minh h\u1ecda nh\u01b0 sau:"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(8714).A+"",width:"1393",height:"1004"})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h4,{id:"implementing-a-simple-text-tokenizer",children:"Implementing a simple text tokenizer"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"C\xe1c b\u1ed9 tokenizer th\u01b0\u1eddng c\xf3 2 ph\u01b0\u01a1ng th\u1ee9c chung:"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"Encoder"}),": nh\u1eadn v\xe0o 1 \u0111o\u1ea1n v\u0103n b\u1ea3n m\u1eabu, t\xe1ch n\xf3 th\xe0nh token ri\xeang l\u1ebb r\u1ed3i chuy\u1ec3n th\xe0nh c\xe1c ID token."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"Decoder"}),": nh\u1eadn v\xe0o c\xe1c ID token, chuy\u1ec3n ng\u01b0\u1ee3c th\xe0nh v\u0103n b\u1ea3n."]}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(6467).A+"",width:"1429",height:"852"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Ph\u1ea7n code minh h\u1ecda s\u1ebd \u0111\u01b0\u1ee3c tr\xecnh b\xe0y trong ",(0,c.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/1.%20Tokenizing.ipynb",children:(0,c.jsx)(e.code,{children:"1. Tokenizing.ipynb"})})]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["C\xf3 m\u1ed9t v\u1ea5n \u0111\u1ec1 l\xe0 v\u1edbi nh\u1eefng t\u1eeb m\xe0 ",(0,c.jsx)(e.em,{children:"vocabulary"})," ch\u01b0a c\xf3, ",(0,c.jsx)(e.code,{children:"tokenizer"})," s\u1ebd kh\xf4ng \xe1nh x\u1ea1 sang ",(0,c.jsx)(e.em,{children:"token IDs"})," \u0111\u01b0\u1ee3c. \u0110i\u1ec1u n\xe0y cho th\u1ea5y c\u1ea7n ph\u1ea3i chu\u1ea9n b\u1ecb 1 t\u1eadp training l\u1edbn v\xe0 \u0111a d\u1ea1ng h\u01a1n \u0111\u1ec3 m\u1edf r\u1ed9ng cho ",(0,c.jsx)(e.em,{children:"vocabulary"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["\u1ede ph\u1ea7n sau, ta s\u1ebd ti\u1ebfp t\u1ee5c th\u1eed nghi\u1ec7m ",(0,c.jsx)(e.code,{children:"tokenizer"})," tr\xean v\u0103n b\u1ea3n ch\u1ee9a nh\u1eefng t\u1eeb m\xe0 ",(0,c.jsx)(e.em,{children:"vocabulary"})," ch\u01b0a c\xf3, \u0111\u1ed3ng th\u1eddi th\u1ea3o lu\u1eadn v\u1ec1 c\xe1c ",(0,c.jsx)(e.code,{children:"token \u0111\u1eb7c bi\u1ec7t"})," b\u1ed5 sung c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 cung c\u1ea5p th\xeam ng\u1eef c\u1ea3nh cho LLM trong qu\xe1 tr\xecnh training."]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"adding-special-context-tokens",children:"Adding special context tokens"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["\u1ede ph\u1ea7n n\xe0y, ta s\u1ebd b\u1ed5 sung ",(0,c.jsx)(e.em,{children:"vocabulary"})," \u0111\xe3 tri\u1ec3n khai \u1edf ph\u1ea7n tr\u01b0\u1edbc \u0111\u1ec3 h\u1ed7 tr\u1ee3 2 token m\u1edbi l\xe0 ",(0,c.jsx)(e.code,{children:"<|unk|>"})," v\xe0 ",(0,c.jsx)(e.code,{children:"<|endoftext|>"})]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(4147).A+"",width:"1366",height:"899"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Nh\u01b0 h\xecnh \u1edf tr\xean, ta c\xf3 th\u1ec3 cho ",(0,c.jsx)(e.code,{children:"tokenizer"})," s\u1eed d\u1ee5ng token ",(0,c.jsx)(e.code,{children:"<|unk|>"})," n\u1ebfu g\u1eb7p 1 t\u1eeb kh\xf4ng n\u1eb1m trong ",(0,c.jsx)(e.em,{children:"vocabulary"})," v\xe0 token ",(0,c.jsx)(e.code,{children:"<|endoftext|>"})," gi\u1eefa 2 \u0111o\u1ea1n v\u0103n b\u1ea3n kh\xf4ng li\xean quan."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"V\xed d\u1ee5, khi hu\u1ea5n luy\u1ec7n c\xe1c LLM ki\u1ec3u GPT tr\xean nhi\u1ec1u t\xe0i li\u1ec7u ho\u1eb7c s\xe1ch \u0111\u1ed9c l\u1eadp, vi\u1ec7c ch\xe8n m\u1ed9t token tr\u01b0\u1edbc m\u1ed7i t\xe0i li\u1ec7u ho\u1eb7c cu\u1ed1n s\xe1ch ti\u1ebfp n\u1ed1i sau m\u1ed9t ngu\u1ed3n v\u0103n b\u1ea3n tr\u01b0\u1edbc \u0111\xf3 l\xe0 \u0111i\u1ec1u th\u01b0\u1eddng g\u1eb7p \u0111\u1ec3 gi\xfap LLM hi\u1ec3u r\u1eb1ng m\u1eb7c d\xf9 c\xe1c v\u0103n b\u1ea3n n\xe0y \u0111\u01b0\u1ee3c n\u1ed1i l\u1ea1i \u0111\u1ec3 training, nh\u01b0ng ch\xfang kh\xf4ng li\xean quan \u0111\u1ebfn nhau."}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Code tri\u1ec3n khai xem th\xeam t\u1ea1i ",(0,c.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/1.%20Tokenizing.ipynb",children:(0,c.jsx)(e.code,{children:"1. Tokenizing.ipynb"})})]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"T\xf9y thu\u1ed9c v\xe0o t\u1eebng m\xf4 h\xecnh LLM, m\u1ed9t s\u1ed1 nh\xe0 nghi\xean c\u1ee9u c\xf2n xem x\xe9t th\xeam c\xe1c token \u0111\u1eb7c bi\u1ec7t nh\u01b0:"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"[BOS] (beginning of sequence)"}),": \u0111\xe1nh d\u1ea5u s\u1ef1 b\u1eaft \u0111\u1ea7u c\u1ee7a 1 v\u0103n b\u1ea3n."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"[EOS] (end of sequence)"}),": Token n\u1eb1m \u1edf cu\u1ed1i v\u0103n b\u1ea3n, t\u01b0\u01a1ng t\u1ef1 nh\u01b0 ",(0,c.jsx)(e.code,{children:"<|endoftext|>"}),"."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"[PAD] (padding)"}),": Khi training LLM v\u1edbi ",(0,c.jsx)(e.em,{children:"batch_size > 1"}),", \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o c\xe1c v\u0103n b\u1ea3n c\xf3 c\xf9ng \u0111\u1ed9 d\xe0i, nh\u1eefng v\u0103n b\u1ea3n ng\u1eafn h\u01a1n s\u1ebd \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng ho\u1eb7c th\xeam b\u1eb1ng token ",(0,c.jsx)(e.code,{children:"[PAD]"})," cho \u0111\u1ebfn khi b\u1eb1ng v\u1edbi \u0111\u1ed9 d\xe0i v\u0103n b\u1ea3n d\xe0i nh\u1ea5t trong ",(0,c.jsx)(e.em,{children:"batch"}),"."]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["L\u01b0u \xfd r\u1eb1ng c\xe1c token \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho m\xf4 h\xecnh GPT kh\xf4ng c\u1ea7n nh\u1eefng token tr\xean, ch\u1ec9 d\xf9ng ",(0,c.jsx)(e.code,{children:"<|endoftext|>"})," cho \u0111\u01a1n gi\u1ea3n. Token ",(0,c.jsx)(e.code,{children:"<|endoftext|>"})," t\u01b0\u01a1ng t\u1ef1 nh\u01b0 token ",(0,c.jsx)(e.code,{children:"[EOS]"})," n\xeau tr\xean, \u0111\u1ed3ng th\u1eddi, ",(0,c.jsx)(e.code,{children:"<|endoftext|>"})," c\u0169ng \u0111\u01b0\u1ee3c d\xf9ng \u0111\u1ec3 padding. Tuy nhi\xean, ch\xfang ta s\u1ebd kh\xe1m ph\xe1 \u1edf c\xe1c ch\u01b0\u01a1ng sau, khi training tr\xean ",(0,c.jsx)(e.em,{children:"d\u1eef li\u1ec7u batch"}),", ta th\u01b0\u1eddng s\u1eed d\u1ee5ng ",(0,c.jsx)(e.code,{children:"mask"})," (ngh\u0129a l\xe0 b\u1ecf qua c\xe1c token \u0111\u01b0\u1ee3c ",(0,c.jsx)(e.em,{children:"padding"}),"). Nh\u01b0 v\u1eady, token n\xe0o \u0111\u01b0\u1ee3c ch\u1ecdn \u0111\u1ec3 ",(0,c.jsx)(e.em,{children:"padding"})," kh\xf4ng c\xf2n quan tr\u1ecdng n\u1eefa."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Ngo\xe0i ra, ",(0,c.jsx)(e.code,{children:"tokenizer"})," d\xf9ng cho GPT c\u0169ng kh\xf4ng s\u1eed d\u1ee5ng ",(0,c.jsx)(e.code,{children:"<|unk|>"})," cho nh\u1eefng t\u1eeb ngo\xe0i ",(0,c.jsx)(e.em,{children:"vocabulary"}),". Thay v\xe0o \u0111\xf3, c\xe1c m\xf4 h\xecnh GPT s\u1eed d\u1ee5ng ",(0,c.jsx)(e.code,{children:"BPE (Byte Pair Encoding)"})," Tokenizer - m\u1ed9t ph\u01b0\u01a1ng ph\xe1p chia nh\u1ecf t\u1eeb th\xe0nh c\xe1c `subword units (\u0111\u01a1n v\u1ecb con) - \u0111i\u1ec1u m\xe0 ch\xfang ta s\u1ebd th\u1ea3o lu\u1eadn \u1edf ph\u1ea7n ti\u1ebfp theo."]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"byte-pair-encoding",children:"Byte Pair Encoding"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Thu\u1eadt to\xe1n c\u1ee7a ",(0,c.jsx)(e.code,{children:"BPE"})," s\u1ebd t\xe1ch nh\u1eefng t\u1eeb kh\xf4ng c\xf3 trong ",(0,c.jsx)(e.em,{children:"vocabulary"})," th\xe0nh c\xe1c ",(0,c.jsx)(e.code,{children:"subword units"})," ho\u1eb7c th\u1eadm ch\xed th\xe0nh t\u1eebng k\xed t\u1ef1 ri\xeang l\u1ebb, cho ph\xe9p x\u1eed l\xed \u0111\u01b0\u1ee3c c\xe1c t\u1eeb n\u1eb1m ngo\xe0i ",(0,c.jsx)(e.em,{children:"vocabulary"}),"."]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(7539).A+"",width:"996",height:"529"})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"data-sampling-with-a-sliding-window",children:"Data sampling with a sliding window"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["C\xe1c ph\u1ea7n tr\u01b0\u1edbc \u0111\xe3 tr\xecnh b\xe0y chi ti\u1ebft v\u1ec1 c\xe1c b\u01b0\u1edbc tokenization v\xe0 vi\u1ec7c chuy\u1ec3n \u0111\u1ed5i t\u1eeb c\xe1c ",(0,c.jsx)(e.code,{children:"token d\u1ea1ng chu\u1ed7i"})," sang c\xe1c ",(0,c.jsx)(e.code,{children:"token IDs d\u1ea1ng integer"}),". B\u01b0\u1edbc ti\u1ebfp theo, tr\u01b0\u1edbc khi c\xf3 th\u1ec3 t\u1ea1o ra ",(0,c.jsx)(e.code,{children:"embeddings"})," cho LLM, l\xe0 c\u1ea7n t\u1ea1o ra c\xe1c c\u1eb7p ",(0,c.jsx)(e.code,{children:"input-target"})," \u0111\u1ec3 train LLM nh\u01b0 h\xecnh d\u01b0\u1edbi \u0111\xe2y:"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(4012).A+"",width:"1180",height:"734"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Trong ph\u1ea7n n\xe0y ta s\u1ebd tri\u1ec3n khai m\u1ed9t ",(0,c.jsx)(e.code,{children:"Data Loader"})," \u0111\u1ec3 l\u1ea5y ra c\xe1c c\u1eb7p ",(0,c.jsx)(e.code,{children:"input-target"})," ki\u1ec3u nh\u01b0 sau:"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(5968).A+"",width:"1347",height:"1098"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["\u0110\u1ec3 tri\u1ec3n khai ",(0,c.jsx)(e.code,{children:"Data Loader"})," hi\u1ec7u qu\u1ea3, ta \u0111\u01b0a ",(0,c.jsx)(e.code,{children:"input"})," v\xe0o 1 ",(0,c.jsx)(e.code,{children:"Tensor X"}),", trong \u0111\xf3 m\u1ed7i h\xe0ng bi\u1ec3u di\u1ec5n ng\u1eef c\u1ea3nh \u0111\u1ea7u v\xe0o. ",(0,c.jsx)(e.code,{children:"Tensor Y"})," ch\u1ee9a c\xe1c ",(0,c.jsx)(e.code,{children:"target"})," t\u01b0\u01a1ng \u1ee9ng, \u0111\u01b0\u1ee3c t\u1ea1o ra b\u1eb1ng c\xe1ch ",(0,c.jsx)(e.code,{children:"d\u1ecbch \u0111\u1ea7u 1 v\u1ecb tr\xed"}),":"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(3550).A+"",width:"1336",height:"669"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Khi t\u1ea1o nhi\u1ec1u ",(0,c.jsx)(e.code,{children:"batch"})," t\u1eeb ",(0,c.jsx)(e.code,{children:"input dataset"}),", ta s\u1eed d\u1ee5ng ",(0,c.jsx)(e.code,{children:"sliding window"})," tr\xean v\u0103n b\u1ea3n."]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["N\u1ebfu ",(0,c.jsx)(e.code,{children:"stride == 1"}),", ",(0,c.jsx)(e.code,{children:"input window"})," s\u1ebd d\u1ecbch sang ",(0,c.jsx)(e.code,{children:"1 v\u1ecb tr\xed"})," khi t\u1ea1o batch ti\u1ebfp theo."]}),"\n",(0,c.jsxs)(e.li,{children:["N\u1ebfu \u0111\u1eb7t ",(0,c.jsx)(e.code,{children:"stride"})," b\u1eb1ng v\u1edbi k\xedch th\u01b0\u1edbc c\u1eeda s\u1ed5 \u0111\u1ea7u v\xe0o (",(0,c.jsx)(e.code,{children:"max_length"}),"), ta c\xf3 th\u1ec3 tr\xe1nh \u0111\u01b0\u1ee3c ",(0,c.jsx)(e.code,{children:"overlap"})," gi\u1eefa c\xe1c batch."]}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(7767).A+"",width:"1439",height:"1026"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Code tri\u1ec3n khai c\xf3 th\u1ec3 xem qua ",(0,c.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/3.%20Data_sampling.ipynb",children:(0,c.jsx)(e.code,{children:"3. Data_sampling.ipynb"})})]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"creating-token-embeddings",children:"Creating Token Embeddings"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(2389).A+"",width:"1580",height:"1123"})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["C\xe1c ",(0,c.jsx)(e.code,{children:"tr\u1ecdng s\u1ed1 embedding"})," s\u1ebd \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o ng\u1eabu nhi\xean ban \u0111\u1ea7u. C\xe1c ",(0,c.jsx)(e.code,{children:"weights"})," n\xe0y s\u1ebd \u0111\u01b0\u1ee3c ",(0,c.jsx)(e.em,{children:"t\u1ed1i \u01b0u h\xf3a"})," trong qu\xe1 tr\xecnh training LLM."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["M\u1ed9t ",(0,c.jsx)(e.code,{children:"bi\u1ec3u di\u1ec5n vector li\xean t\u1ee5c (continuous vector representation)"}),", hay c\xf2n g\u1ecdi l\xe0 ",(0,c.jsx)(e.code,{children:"embedding"}),", \u0111\u01b0\u1ee3c hu\u1ea5n luy\u1ec7n b\u1edfi thu\u1eadt to\xe1n ",(0,c.jsx)(e.code,{children:"lan truy\u1ec1n ng\u01b0\u1ee3c (backpropagation)"})," (C\xf3 th\u1ec3 \u0111\u1ecdc th\xeam t\u1ea1i ",(0,c.jsx)(e.em,{children:"Appendix A.4, Automatic differentiation made easy"}),")"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Ph\u1ea7n code minh h\u1ecda xem th\xeam t\u1ea1i ",(0,c.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/4.%20Token_embedding.ipynb",children:(0,c.jsx)(e.code,{children:"4. Token_embedding.ipynb"})})]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h3,{id:"embedding-layer-v\xe0-matrix-multiplication-nh\xe2n-ma-tr\u1eadn",children:"Embedding Layer v\xe0 Matrix Multiplication (Nh\xe2n ma tr\u1eadn)"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Tr\u01b0\u1edbc ti\xean ta c\xf9ng \xf4n l\u1ea1i m\u1ed9t ch\xfat v\u1ec1 kh\xe1i ni\u1ec7m ",(0,c.jsx)(e.code,{children:"one-hot encoding"}),". K\u0129 thu\u1eadt n\xe0y s\u1ebd chuy\u1ec3n \u0111\u1ed5i ",(0,c.jsx)(e.em,{children:"categorical data"})," th\xe0nh vector nh\u1ecb ph\xe2n:"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["M\u1ed7i ph\u1ea7n t\u1eed s\u1ebd l\xe0 ",(0,c.jsx)(e.em,{children:"0 ho\u1eb7c 1"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Ch\u1ec9 c\xf3 duy nh\u1ea5t 1 v\u1ecb tr\xed b\u1eb1ng ",(0,c.jsx)(e.em,{children:"1"}),", c\xf2n l\u1ea1i ",(0,c.jsx)(e.em,{children:"0"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["V\xed d\u1ee5, ",(0,c.jsx)(e.code,{children:'["cat", "dog", "tiger"]'}),":"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.code,{children:'"cat" -> [1, 0, 0]'})}),"\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.code,{children:'"dog" -> [0, 1, 0]'})}),"\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.code,{children:'"tiger" -> [0, 0, 1]'})}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Tr\u01b0\u1edbc \u0111\xe2y, ",(0,c.jsx)(e.code,{children:"one-hot encoding"})," th\u01b0\u1eddng d\xf9ng \u0111\u1ec3 bi\u1ec3u di\u1ec5n ",(0,c.jsx)(e.em,{children:"token/word"})," nh\u01b0ng vector n\xe0y r\u1ea5t ",(0,c.jsx)(e.em,{children:"th\u01b0a (sparse)"})," & ",(0,c.jsx)(e.em,{children:"c\xf3 chi\u1ec1u r\u1ea5t l\u1edbn"}),", v\xec v\u1eady \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng ",(0,c.jsx)(e.code,{children:"embedding layer"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["V\xed d\u1ee5: ",(0,c.jsx)(e.em,{children:"GPT-3 c\xf3 vocab ~50k \u2192 m\u1ed7i token th\xe0nh vector 50k chi\u1ec1u, trong \u0111\xf3 49,999 ph\u1ea7n t\u1eed = 0"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"Embedding layer"})," th\u1ef1c ch\u1ea5t l\xe0 ",(0,c.jsx)(e.code,{children:"one-hot vector"})," x ",(0,c.jsx)(e.code,{children:"weights matrix"})," (",(0,c.jsxs)(e.span,{className:"katex",children:[(0,c.jsx)(e.span,{className:"katex-mathml",children:(0,c.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,c.jsxs)(e.semantics,{children:[(0,c.jsx)(e.mrow,{children:(0,c.jsx)(e.mi,{mathvariant:"bold",children:"W"})}),(0,c.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\mathbf{W}"})]})})}),(0,c.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,c.jsxs)(e.span,{className:"base",children:[(0,c.jsx)(e.span,{className:"strut",style:{height:"0.6861em"}}),(0,c.jsx)(e.span,{className:"mord mathbf",style:{marginRight:"0.01597em"},children:"W"})]})})]}),")."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["T\u1eeb code minh h\u1ecda, c\xf3 th\u1ec3 h\xecnh dung c\xe1ch ",(0,c.jsx)(e.code,{children:"embedding layer"})," ho\u1ea1t \u0111\u1ed9ng. N\u1ebfu ",(0,c.jsxs)(e.em,{children:["input ",(0,c.jsxs)(e.span,{className:"katex",children:[(0,c.jsx)(e.span,{className:"katex-mathml",children:(0,c.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,c.jsxs)(e.semantics,{children:[(0,c.jsx)(e.mrow,{children:(0,c.jsx)(e.mi,{mathvariant:"script",children:"x"})}),(0,c.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\mathcal{x}"})]})})}),(0,c.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,c.jsxs)(e.span,{className:"base",children:[(0,c.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,c.jsx)(e.span,{className:"mord mathnormal",children:"x"})]})})]})]})," l\xe0 ",(0,c.jsx)(e.code,{children:"one-hot vector"})," (ch\u1ec9 c\xf3 m\u1ed9t gi\xe1 tr\u1ecb b\u1eb1ng 1), th\xec khi nh\xe2n v\u1edbi ",(0,c.jsx)(e.code,{children:"weights matrix"})," (",(0,c.jsxs)(e.span,{className:"katex",children:[(0,c.jsx)(e.span,{className:"katex-mathml",children:(0,c.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,c.jsxs)(e.semantics,{children:[(0,c.jsx)(e.mrow,{children:(0,c.jsx)(e.mi,{mathvariant:"bold",children:"W"})}),(0,c.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\mathbf{W}"})]})})}),(0,c.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,c.jsxs)(e.span,{className:"base",children:[(0,c.jsx)(e.span,{className:"strut",style:{height:"0.6861em"}}),(0,c.jsx)(e.span,{className:"mord mathbf",style:{marginRight:"0.01597em"},children:"W"})]})})]}),") ",(0,c.jsxs)(e.span,{className:"katex",children:[(0,c.jsx)(e.span,{className:"katex-mathml",children:(0,c.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,c.jsxs)(e.semantics,{children:[(0,c.jsx)(e.mrow,{children:(0,c.jsx)(e.mo,{children:"\u2192"})}),(0,c.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\rightarrow"})]})})}),(0,c.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,c.jsxs)(e.span,{className:"base",children:[(0,c.jsx)(e.span,{className:"strut",style:{height:"0.3669em"}}),(0,c.jsx)(e.span,{className:"mrel",children:"\u2192"})]})})]})," ch\xednh l\xe0 ch\u1ecdn ra ",(0,c.jsx)(e.code,{children:"1 h\xe0ng"})," c\u1ee7a ",(0,c.jsxs)(e.span,{className:"katex",children:[(0,c.jsx)(e.span,{className:"katex-mathml",children:(0,c.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,c.jsxs)(e.semantics,{children:[(0,c.jsx)(e.mrow,{children:(0,c.jsx)(e.mi,{mathvariant:"bold",children:"W"})}),(0,c.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\mathbf{W}"})]})})}),(0,c.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,c.jsxs)(e.span,{className:"base",children:[(0,c.jsx)(e.span,{className:"strut",style:{height:"0.6861em"}}),(0,c.jsx)(e.span,{className:"mord mathbf",style:{marginRight:"0.01597em"},children:"W"})]})})]}),"."]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(4734).A+"",width:"1513",height:"796"})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"encoding-word-positions",children:"Encoding Word Positions"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["\u1ede ph\u1ea7n tr\u01b0\u1edbc ta \u0111\xe3 x\u1eed l\xfd xong t\u1eeb ",(0,c.jsx)(e.code,{children:"token"})," ",(0,c.jsxs)(e.span,{className:"katex",children:[(0,c.jsx)(e.span,{className:"katex-mathml",children:(0,c.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,c.jsxs)(e.semantics,{children:[(0,c.jsx)(e.mrow,{children:(0,c.jsx)(e.mo,{children:"\u2192"})}),(0,c.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\rightarrow"})]})})}),(0,c.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,c.jsxs)(e.span,{className:"base",children:[(0,c.jsx)(e.span,{className:"strut",style:{height:"0.3669em"}}),(0,c.jsx)(e.span,{className:"mrel",children:"\u2192"})]})})]})," ",(0,c.jsx)(e.code,{children:"token embedding"}),". Tuy nhi\xean, LLM c\xf3 1 h\u1ea1n ch\u1ebf l\xe0 c\u01a1 ch\u1ebf ",(0,c.jsx)(e.code,{children:"self-attention"})," (s\u1ebd \u0111\u01b0\u1ee3c t\xecm hi\u1ec3u \u1edf c\xe1c ph\u1ea7n sau) ",(0,c.jsx)(e.em,{children:'"kh\xf4ng c\xf3 kh\xe1i ni\u1ec7m v\u1ec1 v\u1ecb tr\xed hay th\u1ee9 t\u1ef1 c\u1ee7a c\xe1c token trong chu\u1ed7i"'}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["C\xe1ch m\xe0 ",(0,c.jsx)(e.code,{children:"embedding layer"})," ho\u1ea1t \u0111\u1ed9ng l\xe0 ",(0,c.jsx)(e.em,{children:"c\xf9ng 1 token ID lu\xf4n \u0111\u01b0\u1ee3c \xe1nh x\u1ea1 th\xe0nh c\xf9ng 1 vector, b\u1ea5t k\u1ec3 xu\u1ea5t hi\u1ec7n \u1edf v\u1ecb tr\xed n\xe0o"}),". \u0110i\u1ec1u n\xe0y \u0111\u01b0\u1ee3c minh h\u1ecda nh\u01b0 sau:"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(9677).A+"",width:"1191",height:"824"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["V\u1ec1 nguy\xean t\u1eafc, ",(0,c.jsx)(e.code,{children:"embedding layer"})," ho\u1ea1t \u0111\u1ed9ng c\xf3 ",(0,c.jsx)(e.em,{children:"t\xednh nh\u1ea5t qu\xe1n"})," nh\u01b0 v\u1eady s\u1ebd gi\xfap m\xf4 h\xecnh h\u1ecdc \u1ed5n \u0111\u1ecbnh, tuy nhi\xean m\xf4 h\xecnh s\u1ebd ",(0,c.jsx)(e.em,{children:"kh\xf4ng nh\u1eadn bi\u1ebft \u0111\u01b0\u1ee3c v\u1ecb tr\xed"})," (",(0,c.jsx)(e.code,{children:"H\xf4m nay tr\u1eddi \u0111\u1eb9p"})," & ",(0,c.jsx)(e.code,{children:"\u0110\u1eb9p tr\u1eddi h\xf4m nay"})," l\xe0 2 t\u1eadp vector gi\u1ed1ng nhau)."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["B\xean c\u1ea1nh \u0111\xf3, c\u01a1 ch\u1ebf ",(0,c.jsx)(e.code,{children:"self-attention"})," c\u1ee7a LLM c\u0169ng ",(0,c.jsx)(e.em,{children:"kh\xf4ng nh\u1eadn bi\u1ebft \u0111\u01b0\u1ee3c v\u1ecb tr\xed"}),", n\xean vi\u1ec7c b\u1ed5 sung ",(0,c.jsx)(e.em,{children:"th\xf4ng tin v\u1ecb tr\xed"})," tr\u01b0\u1edbc khi b\u1eaft \u0111\u1ea7u training l\xe0 c\u1ea7n thi\u1ebft."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["\u1ede \u0111\xe2y ch\xfang ta s\u1ebd s\u1eed d\u1ee5ng ",(0,c.jsx)(e.code,{children:"absolute positional embeddings (embedding v\u1ecb tr\xed tuy\u1ec7t \u0111\u1ed1i)"}),", th\u1ec3 hi\u1ec7n qua \u1ea3nh sau:"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(2558).A+"",width:"1479",height:"538"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["C\xe1c m\xf4 h\xecnh ",(0,c.jsx)(e.code,{children:"GPT"})," c\u1ee7a ",(0,c.jsx)(e.code,{children:"OpenAI"})," s\u1eed d\u1ee5ng ",(0,c.jsx)(e.code,{children:"absolute positional embeddings"})," \u0111\u01b0\u1ee3c t\u1ed1i \u01b0u trong qu\xe1 tr\xecnh ",(0,c.jsx)(e.em,{children:"training"}),", thay v\xec \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a s\u1eb5n nh\u01b0 ",(0,c.jsx)(e.code,{children:"positional encodings"})," trong Transformer g\u1ed1c."]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsxs)(e.span,{className:"katex",children:[(0,c.jsx)(e.span,{className:"katex-mathml",children:(0,c.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,c.jsxs)(e.semantics,{children:[(0,c.jsx)(e.mrow,{children:(0,c.jsxs)(e.munder,{accentunder:"true",children:[(0,c.jsxs)(e.mrow,{children:[(0,c.jsx)(e.mi,{children:"E"}),(0,c.jsx)(e.mi,{children:"n"}),(0,c.jsx)(e.mi,{children:"c"}),(0,c.jsx)(e.mi,{children:"o"}),(0,c.jsx)(e.mi,{children:"d"}),(0,c.jsx)(e.mi,{children:"i"}),(0,c.jsx)(e.mi,{children:"n"}),(0,c.jsx)(e.mi,{children:"g"})]}),(0,c.jsx)(e.mo,{stretchy:"true",children:"\u203e"})]})}),(0,c.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\underline{Encoding} "})]})})}),(0,c.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,c.jsxs)(e.span,{className:"base",children:[(0,c.jsx)(e.span,{className:"strut",style:{height:"1.0889em",verticalAlign:"-0.3944em"}}),(0,c.jsx)(e.span,{className:"mord underline",children:(0,c.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,c.jsxs)(e.span,{className:"vlist-r",children:[(0,c.jsxs)(e.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,c.jsxs)(e.span,{style:{top:"-2.6456em"},children:[(0,c.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,c.jsx)(e.span,{className:"underline-line",style:{borderBottomWidth:"0.04em"}})]}),(0,c.jsxs)(e.span,{style:{top:"-3em"},children:[(0,c.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,c.jsxs)(e.span,{className:"mord",children:[(0,c.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,c.jsx)(e.span,{className:"mord mathnormal",children:"n"}),(0,c.jsx)(e.span,{className:"mord mathnormal",children:"co"}),(0,c.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,c.jsx)(e.span,{className:"mord mathnormal",children:"in"}),(0,c.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"})]})]})]}),(0,c.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,c.jsx)(e.span,{className:"vlist-r",children:(0,c.jsx)(e.span,{className:"vlist",style:{height:"0.3944em"},children:(0,c.jsx)(e.span,{})})})]})})]})})]}),": chuy\u1ec3n \u0111\u1ed5i t\u1eeb d\u1eef li\u1ec7u ",(0,c.jsx)(e.em,{children:"d\u1ea1ng n\xe0y sang d\u1ea1ng kh\xe1c"}),". Th\u01b0\u1eddng l\xe0 quy t\u1eafc ho\u1eb7c c\xf4ng th\u1ee9c to\xe1n h\u1ecdc ",(0,c.jsxs)(e.span,{className:"katex",children:[(0,c.jsx)(e.span,{className:"katex-mathml",children:(0,c.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,c.jsxs)(e.semantics,{children:[(0,c.jsx)(e.mrow,{children:(0,c.jsx)(e.mo,{children:"\u2192"})}),(0,c.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\rightarrow"})]})})}),(0,c.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,c.jsxs)(e.span,{className:"base",children:[(0,c.jsx)(e.span,{className:"strut",style:{height:"0.3669em"}}),(0,c.jsx)(e.span,{className:"mrel",children:"\u2192"})]})})]})," c\u1ee9ng, c\u1ed1 \u0111\u1ecbnh."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsxs)(e.span,{className:"katex",children:[(0,c.jsx)(e.span,{className:"katex-mathml",children:(0,c.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,c.jsxs)(e.semantics,{children:[(0,c.jsx)(e.mrow,{children:(0,c.jsxs)(e.munder,{accentunder:"true",children:[(0,c.jsxs)(e.mrow,{children:[(0,c.jsx)(e.mi,{children:"E"}),(0,c.jsx)(e.mi,{children:"m"}),(0,c.jsx)(e.mi,{children:"b"}),(0,c.jsx)(e.mi,{children:"e"}),(0,c.jsx)(e.mi,{children:"d"}),(0,c.jsx)(e.mi,{children:"d"}),(0,c.jsx)(e.mi,{children:"i"}),(0,c.jsx)(e.mi,{children:"n"}),(0,c.jsx)(e.mi,{children:"g"})]}),(0,c.jsx)(e.mo,{stretchy:"true",children:"\u203e"})]})}),(0,c.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\underline{Embedding}"})]})})}),(0,c.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,c.jsxs)(e.span,{className:"base",children:[(0,c.jsx)(e.span,{className:"strut",style:{height:"1.0889em",verticalAlign:"-0.3944em"}}),(0,c.jsx)(e.span,{className:"mord underline",children:(0,c.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,c.jsxs)(e.span,{className:"vlist-r",children:[(0,c.jsxs)(e.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,c.jsxs)(e.span,{style:{top:"-2.6456em"},children:[(0,c.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,c.jsx)(e.span,{className:"underline-line",style:{borderBottomWidth:"0.04em"}})]}),(0,c.jsxs)(e.span,{style:{top:"-3em"},children:[(0,c.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,c.jsxs)(e.span,{className:"mord",children:[(0,c.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,c.jsx)(e.span,{className:"mord mathnormal",children:"mb"}),(0,c.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,c.jsx)(e.span,{className:"mord mathnormal",children:"dd"}),(0,c.jsx)(e.span,{className:"mord mathnormal",children:"in"}),(0,c.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"})]})]})]}),(0,c.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,c.jsx)(e.span,{className:"vlist-r",children:(0,c.jsx)(e.span,{className:"vlist",style:{height:"0.3944em"},children:(0,c.jsx)(e.span,{})})})]})})]})})]}),": ",(0,c.jsx)(e.em,{children:"continuous vector representation"})," ",(0,c.jsxs)(e.span,{className:"katex",children:[(0,c.jsx)(e.span,{className:"katex-mathml",children:(0,c.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,c.jsxs)(e.semantics,{children:[(0,c.jsx)(e.mrow,{children:(0,c.jsx)(e.mo,{children:"\u2192"})}),(0,c.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\rightarrow"})]})})}),(0,c.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,c.jsxs)(e.span,{className:"base",children:[(0,c.jsx)(e.span,{className:"strut",style:{height:"0.3669em"}}),(0,c.jsx)(e.span,{className:"mrel",children:"\u2192"})]})})]})," c\xf3 th\u1ec3 tinh ch\u1ec9nh tham s\u1ed1 qua training."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Code minh h\u1ecda xem \u1edf ",(0,c.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/5.%20Positional_embedding.ipynb",children:(0,c.jsx)(e.code,{children:"5. Positional_embedding.ipynb"})})]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"T\u1ed5ng k\u1ebft l\u1ea1i ph\u1ea7n n\xe0y c\xf3 c\xe1c b\u01b0\u1edbc nh\u01b0 sau:"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:s(1014).A+"",width:"1293",height:"1470"})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.em,{children:"Text \u2192 Token \u2192 Token ID \u2192 Token Embedding \u2192 add Positional Embedding \u2192 Input Embedding \u2192 LLM layers"})}),"\n"]}),"\n"]}),"\n"]})]})}function o(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(r,{...n})}):r(n)}},946:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/embedding-aa32c6d42fcc7007a1c615a84e0343ba.png"},2903:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing-392171e1e60f4886b9263d31b7d09db5.png"},9825:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_01-d089cbc71f306c7e5337781bc133c4c6.png"},8714:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_02-cefcaa50b1f4fc2cd9db0c48d2f29cb9.png"},6467:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_03-335497065414c2ffa2596a4c69947465.png"},4147:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_04_special_tokens-4d01b1530b9662815255bc511227996d.png"},7539:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_05_bpe-7bb1b89547c3a8628085179c9e1f0418.png"},4012:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_06_sampling-d042d0a6ff4116e3903c52fe3f53f889.png"},5968:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_07_input_target-0f3f32be549696b8322a14247ed5b08b.png"},3550:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_08_input_target_torch-b6a164647d7f69102946cb51260ebbe6.png"},7767:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_09_sliding_window-a7b1250c9ceb281314e0227815c1d5a9.png"},2389:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_10_embedding-eb5758737f78dfe502d431da4e5ee4bc.png"},4734:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_11_embedding_W-aa49f70372a36945caa3e30299c24184.png"},9677:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_12_embedding_position-32f757d8e8a29cb2370cfffd44646a9e.png"},2558:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_13_absolute_position-83f5768e5aef49f5ad8a428578c8f3c4.png"},1014:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/tokenizing_14_summary-ac93acfd14d1c980bf02fc9915d35e22.png"},8453:(n,e,s)=>{s.d(e,{R:()=>h,x:()=>l});var i=s(6540);const c={},t=i.createContext(c);function h(n){const e=i.useContext(t);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:h(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);