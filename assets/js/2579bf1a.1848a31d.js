"use strict";(self.webpackChunktyan_blog=self.webpackChunktyan_blog||[]).push([[422],{9276:(s,e,n)=>{n.r(e),n.d(e,{assets:()=>h,contentTitle:()=>t,default:()=>d,frontMatter:()=>c,metadata:()=>a,toc:()=>r});const a=JSON.parse('{"id":"build-llm-from-scratch/llm-architecture-01","title":"4. LLM Architecture (Part 01)","description":"4.1. Code LLM architecture","source":"@site/docs/build-llm-from-scratch/4. llm-architecture-01.md","sourceDirName":"build-llm-from-scratch","slug":"/build-llm-from-scratch/llm-architecture-01","permalink":"/tyan-blog/docs/build-llm-from-scratch/llm-architecture-01","draft":false,"unlisted":false,"editUrl":"https://github.com/tyanfarm/tyan-blog/tree/main/docs/build-llm-from-scratch/4. llm-architecture-01.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"4. LLM Architecture (Part 01)"},"sidebar":"tutorialSidebar","previous":{"title":"3. Coding Attention Mechanisms (Part 05)","permalink":"/tyan-blog/docs/build-llm-from-scratch/attention-mechanisms-05"},"next":{"title":"Appendix","permalink":"/tyan-blog/docs/build-llm-from-scratch/appendix"}}');var i=n(4848),l=n(8453);const c={sidebar_position:8,title:"4. LLM Architecture (Part 01)"},t=void 0,h={},r=[{value:"4.1. Code LLM architecture",id:"41-code-llm-architecture",level:2},{value:"GPT Backbone",id:"gpt-backbone",level:3},{value:"Layer Normalization",id:"layer-normalization",level:3},{value:"T\u1ea1i sao l\u1ea1i c\u1ea7n Standardization Z-score?",id:"t\u1ea1i-sao-l\u1ea1i-c\u1ea7n-standardization-z-score",level:5},{value:"H\xe0m k\xedch ho\u1ea1t (Activations)",id:"h\xe0m-k\xedch-ho\u1ea1t-activations",level:5},{value:"Chi\u1ec1u (dimension) khi t\xednh <em>mean</em>",id:"chi\u1ec1u-dimension-khi-t\xednh-mean",level:5},{value:"GeLU Activations",id:"gelu-activations",level:3},{value:"Feed Forward Network",id:"feed-forward-network",level:3},{value:"Shortcut Connections",id:"shortcut-connections",level:3},{value:"Transformer Block",id:"transformer-block",level:3},{value:"GPT model",id:"gpt-model",level:3}];function m(s){const e={a:"a",annotation:"annotation",code:"code",em:"em",h2:"h2",h3:"h3",h5:"h5",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msqrt:"msqrt",msup:"msup",munder:"munder",p:"p",path:"path",semantics:"semantics",span:"span",svg:"svg",ul:"ul",...(0,l.R)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"41-code-llm-architecture",children:"4.1. Code LLM architecture"}),"\n",(0,i.jsx)(e.h3,{id:"gpt-backbone",children:"GPT Backbone"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"C\xe1c m\xf4 h\xecnh Ng\xf4n ng\u1eef l\u1edbn (LLM) nh\u01b0 GPT (Generative Pretrained Transformer) l\xe0 nh\u1eefng ki\u1ebfn tr\xfac m\u1ea1ng n\u01a1-ron c\xf3 k\xedch th\u01b0\u1edbc kh\u1ed5ng l\u1ed3."}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Tuy nhi\xean, ki\u1ebfn tr\xfac c\u1ee7a m\xf4 h\xecnh n\xe0y th\u1ef1c ch\u1ea5t l\u1ea1i \xedt ph\u1ee9c t\u1ea1p h\u01a1n b\u1ea1n t\u01b0\u1edfng, b\u1edfi nhi\u1ec1u th\xe0nh ph\u1ea7n b\xean trong \u0111\u01b0\u1ee3c l\u1eb7p \u0111i l\u1eb7p l\u1ea1i (ch\xfang ta s\u1ebd t\xecm hi\u1ec3u sau)."}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"alt",src:n(6270).A+"",width:"896",height:"718"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Ph\xeda tr\xean l\xe0 h\xecnh m\xf4 t\u1ea3 t\u1ed5ng qu\xe1t v\u1ec1 ",(0,i.jsx)(e.em,{children:"1 m\xf4 h\xecnh GPT"}),". B\xean c\u1ea1nh c\xe1c ",(0,i.jsx)(e.code,{children:"embedding layers"})," & ",(0,i.jsx)(e.code,{children:"inputs tokenization"}),", n\xf3 bao g\u1ed3m ",(0,i.jsx)(e.em,{children:"1 ho\u1eb7c nhi\u1ec1u"})," kh\u1ed1i ",(0,i.jsx)(e.code,{children:"Transformer"})," ch\u1ee9a module ",(0,i.jsx)(e.code,{children:"masked multi-head attention"})," (\u0111\xe3 tri\u1ec3n khai \u1edf ch\u01b0\u01a1ng tr\u01b0\u1edbc)."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Tr\u1ecdng t\xe2m \u1edf ch\u01b0\u01a1ng n\xe0y s\u1ebd tri\u1ec3n khai ",(0,i.jsx)(e.em,{children:"core"})," c\u1ee7a LLM, bao g\u1ed3m c\xe1c ",(0,i.jsx)(e.em,{children:"kh\u1ed1i transformer"}),", sau \u0111\xf3 ch\xfang ta s\u1ebd ",(0,i.jsx)(e.em,{children:"hu\u1ea5n luy\u1ec7n"})," \u1edf ch\u01b0\u01a1ng ti\u1ebfp theo \u0111\u1ec3 t\u1ea1o ra v\u0103n b\u1ea3n gi\u1ed1ng con ng\u01b0\u1eddi."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"D\u01b0\u1edbi \u0111\xe2y l\xe0 m\xf4 t\u1ea3 c\xe1c b\u01b0\u1edbc \u0111\u1ec3 build 1 m\xf4 h\xecnh GPT ho\xe0n ch\u1ec9nh."}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"alt",src:n(1319).A+"",width:"1068",height:"449"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["B\u1eaft \u0111\u1ea7u v\u1edbi b\u01b0\u1edbc \u0111\u1ea7u ti\xean l\xe0 x\xe2y d\u1ef1ng ",(0,i.jsx)(e.code,{children:"GPT Backbone"}),", ta s\u1ebd tri\u1ec3n khai 1 class l\xe0 ",(0,i.jsx)(e.code,{children:"DummyGPTModel"})," - phi\xean b\u1ea3n \u0111\u01a1n gi\u1ea3n h\xf3a c\u1ee7a m\xf4 h\xecnh GPT, s\u1eed d\u1ee5ng module neural network c\u1ee7a Pytorch ",(0,i.jsx)(e.em,{children:"nn.Module"}),". Ki\u1ebfn tr\xfac c\u1ee7a m\xf4 h\xecnh \u0111\u01b0\u1ee3c tri\u1ec3n khai t\u1ea1i ph\u1ea7n ",(0,i.jsx)(e.code,{children:"1. GPT Backbone"})," trong ",(0,i.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/11.%20Placeholder-GPT.ipynb",children:(0,i.jsx)(e.code,{children:"11. Placeholder-GPT.ipynb"})}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"layer-normalization",children:"Layer Normalization"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Vi\u1ec7c hu\u1ea5n luy\u1ec7n ",(0,i.jsx)(e.code,{children:"deep neural network"})," (m\u1ea1ng n\u01a1-ron s\xe2u) v\u1edbi nhi\u1ec1u t\u1ea7ng ",(0,i.jsx)(e.code,{children:"hidden layer"})," d\u1ec5 g\u1eb7p v\u1ea5n \u0111\u1ec1 nh\u01b0 ",(0,i.jsx)(e.em,{children:"vanishing gradient (tri\u1ec7t ti\xeau \u0111\u1ea1o h\xe0m)"})," hay ",(0,i.jsx)(e.em,{children:"exploding gradient (b\xf9ng n\u1ed5 \u0111\u1ea1o h\xe0m)"}),". \u0110i\u1ec1u n\xe0y c\xf3 ngh\u0129a m\xf4 h\xecnh s\u1ebd g\u1eb7p kh\xf3 kh\u0103n trong vi\u1ec7c t\xecm ra b\u1ed9 tham s\u1ed1 t\u1ed1i \u01b0u \u0111\u1ec3 gi\u1ea3m ",(0,i.jsx)(e.em,{children:"loss"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Ph\u1ea7n n\xe0y ch\xfang ta s\u1ebd tri\u1ec3n khai ",(0,i.jsx)(e.code,{children:"layer normalization"}),". \xdd t\u01b0\u1edfng ch\xednh l\xe0 \u0111i\u1ec1u ch\u1ec9nh c\xe1c gi\xe1 tr\u1ecb k\xedch ho\u1ea1t (",(0,i.jsx)(e.code,{children:"activations"}),") \u0111\u1ea7u ra c\u1ee7a 1 ",(0,i.jsx)(e.em,{children:"hidden layer"})," sao cho ch\xfang c\xf3 ",(0,i.jsxs)(e.em,{children:["gi\xe1 tr\u1ecb trung b\xecnh (",(0,i.jsx)(e.a,{href:"/tyan-blog/docs/machine-learning/base-math/probability-statistics#trung-b%C3%ACnh-c%E1%BB%99ng-mean",children:"mean"}),")"]})," b\u1eb1ng 0 v\xe0 ",(0,i.jsxs)(e.em,{children:["ph\u01b0\u01a1ng sai (",(0,i.jsx)(e.a,{href:"/tyan-blog/docs/machine-learning/base-math/probability-statistics#ph%C6%B0%C6%A1ng-sai-variance",children:"variance"}),")"]})," b\u1eb1ng 1 - vi\u1ec7c \u0111i\u1ec1u ch\u1ec9nh ",(0,i.jsx)(e.em,{children:"mean"})," & ",(0,i.jsx)(e.em,{children:"variance"})," n\xe0y l\xe0 c\u1ee7a ",(0,i.jsx)(e.a,{href:"/tyan-blog/docs/build-llm-from-scratch/bonus-section/normalization#standardization-z-score-normalization",children:"Standardization"}),". \u0110\u1ec3 \xfd th\xeam 1 \u0111i\u1ec1u l\xe0 t\u1ea1i sao l\u1ea1i chu\u1ea9n h\xf3a theo 2 gi\xe1 tr\u1ecb n\xe0y, th\xec b\u1edfi v\xec ",(0,i.jsx)(e.a,{href:"/tyan-blog/docs/machine-learning/base-math/probability-statistics#ph%C3%A2n-ph%E1%BB%91i-chu%E1%BA%A9n-gaussiannormal-distribution",children:"Ph\xe2n ph\u1ed1i chu\u1ea9n"})," d\u1ef1a tr\xean 2 tham s\u1ed1 n\xe0y."]}),"\n",(0,i.jsx)(e.h5,{id:"t\u1ea1i-sao-l\u1ea1i-c\u1ea7n-standardization-z-score",children:"T\u1ea1i sao l\u1ea1i c\u1ea7n Standardization Z-score?"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Khi d\u1eef li\u1ec7u truy\u1ec1n qua t\u1eebng l\u1edbp, n\u1ebfu ",(0,i.jsx)(e.em,{children:"gi\xe1 tr\u1ecb k\xedch ho\u1ea1t"})," thay \u0111\u1ed5i ",(0,i.jsx)(e.em,{children:"qu\xe1 l\u1edbn"})," ho\u1eb7c ",(0,i.jsx)(e.em,{children:"qu\xe1 nh\u1ecf"}),", th\xec khi ",(0,i.jsx)(e.em,{children:"backprobagation"})," s\u1ebd b\u1ecb ",(0,i.jsx)(e.em,{children:"b\xf9ng n\u1ed5"})," ho\u1eb7c ",(0,i.jsx)(e.em,{children:"tri\u1ec7t ti\xeau"})," ",(0,i.jsx)(e.em,{children:"\u0111\u1ea1o h\xe0m"}),". Do \u0111\xf3, ",(0,i.jsx)(e.code,{children:"LayerNorm"})," s\u1eed d\u1ee5ng ",(0,i.jsx)(e.em,{children:"z-score"})," \u0111\u1ec3 chu\u1ea9n h\xf3a d\u1eef li\u1ec7u \u0111\u01b0a v\u1ec1 thang \u0111o chung \u1edf m\u1ed7i b\u01b0\u1edbc."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Trong ",(0,i.jsx)(e.em,{children:"GPT-2"})," v\xe0 c\xe1c ki\u1ebfn tr\xfac ",(0,i.jsx)(e.em,{children:"Transformer"})," hi\u1ec7n \u0111\u1ea1i, ",(0,i.jsx)(e.em,{children:"Layer Normalization"})," th\u01b0\u1eddng \u0111\u01b0\u1ee3c \xe1p d\u1ee5ng ",(0,i.jsx)(e.em,{children:"tr\u01b0\u1edbc v\xe0 sau"})," kh\u1ed1i ",(0,i.jsx)(e.em,{children:"multi-head attention"})," v\xe0 tr\u01b0\u1edbc ",(0,i.jsx)(e.em,{children:"output layer"}),"."]}),"\n",(0,i.jsx)(e.h5,{id:"h\xe0m-k\xedch-ho\u1ea1t-activations",children:"H\xe0m k\xedch ho\u1ea1t (Activations)"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Khi \u0111i qua c\xe1c t\u1ea7ng ",(0,i.jsx)(e.em,{children:"Linear"})," th\xec m\xf4 h\xecnh ch\u1ec9 h\u1ecdc \u0111\u01b0\u1ee3c c\xe1c m\u1ed1i quan h\u1ec7 tuy\u1ebfn t\xednh."]}),"\n",(0,i.jsxs)(e.li,{children:["H\xe0m k\xedch ho\u1ea1t l\xfac n\xe0y gi\xfap m\xf4 h\xecnh h\u1ecdc th\xeam c\xe1c m\u1ed1i quan h\u1ec7 phi tuy\u1ebfn t\xednh. V\xed d\u1ee5 h\xe0m ",(0,i.jsx)(e.em,{children:"ReLU"})," chuy\u1ec3n c\xe1c gi\xe1 tr\u1ecb \xe2m v\u1ec1 0."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Tr\u01b0\u1edbc khi \u0111i v\xe0o ph\u1ea7n tri\u1ec3n khai code ta h\xe3y xem qua s\u01a1 \u0111\u1ed3 t\u1ed5ng quan c\u1ee7a ",(0,i.jsx)(e.em,{children:"layer normalization"}),":"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"alt",src:n(2368).A+"",width:"1137",height:"691"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u1ede h\xecnh tr\xean, khi \u0111i qua t\u1ea7ng ",(0,i.jsx)(e.em,{children:"hidden layer"})," th\xec c\xe1c gi\xe1 tr\u1ecb \u0111\u1ea7u ra s\u1ebd \u0111\u01b0\u1ee3c t\xednh to\xe1n \u0111\u1ec3 \u0111\u01b0a v\u1ec1 tr\u1ea1ng th\xe1i c\xf3 ",(0,i.jsx)(e.em,{children:"mean b\u1eb1ng 0 & variance b\u1eb1ng 1"}),". Qu\xe1 tr\xecnh n\xe0y gi\xfap \u1ed5n \u0111\u1ecbnh d\xf2ng d\u1eef li\u1ec7u v\xe0 t\u0103ng t\u1ed1c \u0111\u1ed9 h\u1ed9i t\u1ee5 m\xf4 h\xecnh."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Code \u0111\u01b0\u1ee3c tri\u1ec3n khai t\u1ea1i ph\u1ea7n ",(0,i.jsx)(e.code,{children:"2. Layer Normalization"})," trong ",(0,i.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/11.%20Placeholder-GPT.ipynb",children:(0,i.jsx)(e.code,{children:"11. Placeholder-GPT.ipynb"})}),"."]}),"\n",(0,i.jsxs)(e.h5,{id:"chi\u1ec1u-dimension-khi-t\xednh-mean",children:["Chi\u1ec1u (dimension) khi t\xednh ",(0,i.jsx)(e.em,{children:"mean"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"alt",src:n(9074).A+"",width:"767",height:"543"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Tr\xean \u0111\xe2y l\xe0 m\xf4 t\u1ea3 v\u1ec1 chi\u1ec1u t\xednh to\xe1n ",(0,i.jsx)(e.em,{children:"mean"})," tr\xean 1 tensor 2D ",(0,i.jsx)(e.em,{children:"[rows, columns]"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Vi\u1ec7c s\u1eed d\u1ee5ng ",(0,i.jsx)(e.code,{children:"dim=-1"})," gi\xfap t\xednh ",(0,i.jsx)(e.em,{children:"mean"})," tr\xean chi\u1ec1u cu\u1ed1i c\xf9ng c\u1ee7a tensor. Sau n\xe0y, khi th\xeam ",(0,i.jsx)(e.em,{children:"chu\u1ea9n h\xf3a l\u1edbp (layer normalization)"})," - n\u01a1i t\u1ea1o ra tensor 3D ",(0,i.jsx)(e.em,{children:"[batch_size, num_tokens, embedding_dim]"})," th\xec vi\u1ec7c gi\u1eef nguy\xean ",(0,i.jsx)(e.em,{children:"dim=-1"})," linh ho\u1ea1t h\u01a1n nhi\u1ec1u so v\u1edbi ph\u1ea3i thay \u0111\u1ed5i th\u1ee7 c\xf4ng t\u1eeb ",(0,i.jsx)(e.em,{children:"dim=1"})," sang ",(0,i.jsx)(e.em,{children:"dim=2"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"alt",src:n(3126).A+"",width:"1160",height:"542"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Ph\u1ea7n sau ta s\u1ebd t\xecm hi\u1ec3u v\u1ec1 ",(0,i.jsx)(e.em,{children:"h\xe0m k\xedch ho\u1ea1t"})," ",(0,i.jsx)(e.code,{children:"GeLU"})," - m\u1ed9t trong c\xe1c h\xe0m k\xedch ho\u1ea1t d\xf9ng trong LLMs, thay cho h\xe0m truy\u1ec1n th\u1ed1ng ",(0,i.jsx)(e.em,{children:"ReLU"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"gelu-activations",children:"GeLU Activations"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Tr\u01b0\u1edbc \u0111\xe2y, h\xe0m k\xedch ho\u1ea1t ",(0,i.jsx)(e.code,{children:"ReLU"})," \u0111\xe3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng ph\u1ed5 bi\u1ebfn trong h\u1ecdc s\xe2u nh\u1edd t\xednh \u0111\u01a1n gi\u1ea3n v\xe0 hi\u1ec7u qu\u1ea3 tr\xean nhi\u1ec1u ki\u1ebfn tr\xfac m\u1ea1ng n\u01a1-ron kh\xe1c nhau. Tuy nhi\xean, trong c\xe1c m\xf4 h\xecnh ng\xf4n ng\u1eef l\u1edbn (LLM), ng\u01b0\u1eddi ta th\u01b0\u1eddng s\u1eed d\u1ee5ng c\xe1c h\xe0m k\xedch ho\u1ea1t kh\xe1c thay th\u1ebf cho ReLU truy\u1ec1n th\u1ed1ng. Hai v\xed d\u1ee5 ti\xeau bi\u1ec3u l\xe0 ",(0,i.jsx)(e.code,{children:"GeLU"})," ",(0,i.jsx)(e.em,{children:"(Gaussian Error Linear Unit)"})," v\xe0 ",(0,i.jsx)(e.code,{children:"SwiGLU"}),(0,i.jsx)(e.em,{children:"(Sigmoid-Weighted Linear Unit)"}),", l\u1ea7n l\u01b0\u1ee3t t\xedch h\u1ee3p c\xe1c ",(0,i.jsx)(e.em,{children:"\u0111\u01a1n v\u1ecb tuy\u1ebfn t\xednh"})," ki\u1ec3m so\xe1t b\u1edfi ",(0,i.jsx)(e.em,{children:"ph\xe2n ph\u1ed1i"})," ",(0,i.jsx)(e.code,{children:"Gaussian"})," & ",(0,i.jsx)(e.code,{children:"Sigmoid"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.em,{children:"H\xe0m k\xedch ho\u1ea1t GeLU"})," c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c tri\u1ec3n khai theo nhi\u1ec1u c\xe1ch kh\xe1c nhau. Phi\xean b\u1ea3n ch\xednh x\xe1c \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh l\xe0 ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"G"}),(0,i.jsx)(e.mi,{children:"E"}),(0,i.jsx)(e.mi,{children:"L"}),(0,i.jsx)(e.mi,{children:"U"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u03a6"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"GELU(x) = x \\Phi(x)"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"GE"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"LU"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mord",children:"\u03a6"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]}),", v\u1edbi ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u03a6"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Phi(x)"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u03a6"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})})]})," l\xe0 ",(0,i.jsx)(e.code,{children:"h\xe0m ph\xe2n ph\u1ed1i t\xedch l\u0169y"})," c\u1ee7a ",(0,i.jsx)(e.a,{href:"/tyan-blog/docs/machine-learning/base-math/probability-statistics#ph%C3%A2n-ph%E1%BB%91i-chu%E1%BA%A9n-gaussiannormal-distribution",children:"Ph\xe2n ph\u1ed1i Gaussian chu\u1ea9n"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Tuy nhi\xean trong th\u1ef1c t\u1ebf ng\u01b0\u1eddi ta th\u01b0\u1eddng tri\u1ec3n khai 1 b\u1ea3n x\u1ea5p x\u1ec9 c\xf3 chi ph\xed t\xednh to\xe1n th\u1ea5p h\u01a1n (GPT-2 g\u1ed1c c\u0169ng s\u1eed d\u1ee5ng):"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"G"}),(0,i.jsx)(e.mi,{children:"E"}),(0,i.jsx)(e.mi,{children:"L"}),(0,i.jsx)(e.mi,{children:"U"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"\u2248"}),(0,i.jsx)(e.mn,{children:"0.5"}),(0,i.jsx)(e.mo,{children:"\u22c5"}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"\u22c5"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mi,{children:"tanh"}),(0,i.jsx)(e.mo,{children:"\u2061"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"["}),(0,i.jsx)(e.msqrt,{children:(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mn,{children:"2"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,i.jsx)(e.mi,{children:"\u03c0"})]})}),(0,i.jsx)(e.mo,{children:"\u22c5"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mn,{children:"0.044715"}),(0,i.jsx)(e.mo,{children:"\u22c5"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mn,{children:"3"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"]"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"GELU(x) \\approx 0.5 \\cdot x \\cdot (1 + \\tanh[\\sqrt{2/\\pi} \\cdot (x + 0.044715 \\cdot x^3)])"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"GE"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"LU"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"\u2248"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"0.5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4445em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord",children:"1"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.24em",verticalAlign:"-0.305em"}}),(0,i.jsx)(e.span,{className:"mop",children:"tanh"}),(0,i.jsx)(e.span,{className:"mopen",children:"["}),(0,i.jsx)(e.span,{className:"mord sqrt",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.935em"},children:[(0,i.jsxs)(e.span,{className:"svg-align",style:{top:"-3.2em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.2em"}}),(0,i.jsxs)(e.span,{className:"mord",style:{paddingLeft:"1em"},children:[(0,i.jsx)(e.span,{className:"mord",children:"2/"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c0"})]})]}),(0,i.jsxs)(e.span,{style:{top:"-2.895em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.2em"}}),(0,i.jsx)(e.span,{className:"hide-tail",style:{minWidth:"1.02em",height:"1.28em"},children:(0,i.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.28em",viewBox:"0 0 400000 1296",preserveAspectRatio:"xMinYMin slice",children:(0,i.jsx)(e.path,{d:"M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z"})})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.305em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"0.044715"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0641em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8141em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"3"})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mclose",children:")])"})]})]})]})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Code \u0111\u01b0\u1ee3c tri\u1ec3n khai t\u1ea1i ph\u1ea7n ",(0,i.jsx)(e.code,{children:"3. GeLU Activations"})," trong ",(0,i.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/11.%20Placeholder-GPT.ipynb",children:(0,i.jsx)(e.code,{children:"11. Placeholder-GPT.ipynb"})}),"."]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"feed-forward-network",children:"Feed Forward Network"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["L\u1edbp ",(0,i.jsx)(e.code,{children:"FeedForward (FNN)"})," l\xe0 1 m\u1ea1ng n\u01a1-ron nh\u1ecf g\u1ed3m ",(0,i.jsx)(e.em,{children:"2 ph\xe9p bi\u1ebfn \u0111\u1ed5i tuy\u1ebfn t\xednh"})," v\xe0 ",(0,i.jsx)(e.em,{children:"1 h\xe0m k\xedch ho\u1ea1t phi tuy\u1ebfn"})," (\u1edf ph\u1ea7n n\xe0y ta s\u1ebd d\xf9ng ",(0,i.jsx)(e.em,{children:"GeLU"}),"):"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.em,{children:"M\u1edf r\u1ed9ng kh\xf4ng gian"}),": FNN \u0111\u01b0a c\xe1c vector \u0111\u1ea7u v\xe0o t\u1eeb kh\xf4ng gian ",(0,i.jsx)(e.em,{children:"embedding-dim"})," l\xean kh\xf4ng gian c\xf3 s\u1ed1 chi\u1ec1u l\u1edbn h\u01a1n (\u1edf ph\u1ea7n n\xe0y l\xe0 ",(0,i.jsx)(e.em,{children:"g\u1ea5p 4 l\u1ea7n"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Sau \u0111\xf3 c\xe1c vector s\u1ebd \u0111\u01b0\u1ee3c \u0111\u01b0a qua ",(0,i.jsx)(e.em,{children:"1 h\xe0m k\xedch ho\u1ea1t"})," \u0111\u1ec3 h\u1ecdc \u0111\u01b0\u1ee3c c\xe1c \u0111\u1eb7c tr\u01b0ng phi tuy\u1ebfn v\xe0 lo\u1ea1i b\u1ecf c\xe1c \u0111\u1eb7c tr\u01b0ng nhi\u1ec5u."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Cu\u1ed1i c\xf9ng, c\xe1c vector \u0111\u01b0\u1ee3c chi\u1ebfu ng\u01b0\u1ee3c l\u1ea1i v\u1ec1 kh\xf4ng gian ban \u0111\u1ea7u \u0111\u1ec3 \u0111i ti\u1ebfp v\xe0o c\xe1c layers sau."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"alt",src:n(4499).A+"",width:"883",height:"570"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Code \u0111\u01b0\u1ee3c tri\u1ec3n khai t\u1ea1i ph\u1ea7n ",(0,i.jsx)(e.code,{children:"4. Feed Forward Network"})," trong ",(0,i.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/11.%20Placeholder-GPT.ipynb",children:(0,i.jsx)(e.code,{children:"11. Placeholder-GPT.ipynb"})}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"shortcut-connections",children:"Shortcut Connections"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.em,{children:"Shortcut Connections"}),", hay c\xf2n g\u1ecdi l\xe0 ",(0,i.jsx)(e.em,{children:"skip ho\u1eb7c residual connections"})," ban \u0111\u1ea7u \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t trong c\xe1c m\u1ea1ng n\u01a1-ron s\xe2u trong l\u0129nh v\u1ef1c CV (Computer Vision) c\u1ee5 th\u1ec3 l\xe0 c\xe1c m\u1ea1ng ",(0,i.jsx)(e.em,{children:"Residual - ResNet"})," nh\u1eb1m gi\u1ea3m thi\u1ec3u th\xe1ch th\u1ee9c v\u1ec1 ",(0,i.jsx)(e.code,{children:"Vanishing Gradient"})," (tri\u1ec7t ti\xeau \u0111\u1ea1o h\xe0m)."]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"alt",src:n(2467).A+"",width:"291",height:"173"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.em,{children:"Vanishing Gradient"})," l\xe0 hi\u1ec7n t\u01b0\u1ee3ng khi m\u1ea1ng qu\xe1 s\xe2u, c\xe1c \u0111\u1ea1o h\xe0m (",(0,i.jsx)(e.em,{children:"gradient"}),") ph\u1ea3i nh\xe2n v\u1edbi nhau nhi\u1ec1u l\u1ea7n khi truy\u1ec1n ng\u01b0\u1ee3c t\u1eeb cu\u1ed1i v\u1ec1 \u0111\u1ea7u (",(0,i.jsx)(e.a,{href:"/tyan-blog/docs/build-llm-from-scratch/appendix#%C4%91%E1%BA%A1o-h%C3%A0m--gradients",children:"Backpropagation"}),"). N\u1ebfu c\xe1c gi\xe1 tr\u1ecb n\xe0y ",(0,i.jsx)(e.em,{children:"nh\u1ecf h\u01a1n 1"})," ch\xfang s\u1ebd c\xe0ng nh\xe2n c\xe0ng nh\u1ecf."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"alt",src:n(4937).A+"",width:"1013",height:"916"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u1ede h\xecnh tr\xean l\xe0 2 m\u1ea1ng n\u01a1-ron s\xe2u g\u1ed3m 5 l\u1edbp ",(0,i.jsx)(e.em,{children:"c\xf3 shortcut connections"})," (b\xean ph\u1ea3i) & ",(0,i.jsx)(e.em,{children:"kh\xf4ng c\xf3 shortcut connections"})," (b\xean tr\xe1i). C\xf3 th\u1ec3 th\u1ea5y \u1edf b\xean tr\xe1i khi v\u1ec1 ",(0,i.jsx)(e.em,{children:"Layer 1"})," th\xec ",(0,i.jsx)(e.em,{children:"gradient"})," n\xf3 \u0111\xe3 v\u1ec1 r\u1ea5t b\xe9."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u0110\u1ec3 d\u1ec5 hi\u1ec3u th\xec ",(0,i.jsx)(e.code,{children:"shortcut connections"})," l\xe0 ",(0,i.jsx)(e.em,{children:"c\u1ed9ng \u0111\u1ea7u ra c\u1ee7a 1 l\u1edbp v\u1edbi gi\xe1 tr\u1ecb \u0111\u1ea7u v\xe0o tr\u01b0\u1edbc khi qua l\u1edbp \u0111\xf3"}),", tri\u1ec3n khai qua c\xf4ng th\u1ee9c sau \u0111\xe2y: ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mi,{children:"x"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"y = f(x) + x"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"})]})]})]})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"x"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"x"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"})]})})]}),": l\xe0 d\u1eef li\u1ec7u \u0111\u1ea7u v\xe0o tr\u01b0\u1edbc khi \u0111i qua l\u1edbp n\u01a1-ron."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"y = f(x)"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]}),": \u0111\u1ea7u ra c\u1ee7a 1 l\u1edbp Linear."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"T\u1ea1i sao l\u1ea1i l\xe0 c\xf4ng th\u1ee9c n\xe0y?"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["V\xec khi \u0111i qua \u0111\u1ea1o h\xe0m th\xec c\xf4ng th\u1ee9c n\xe0y s\u1ebd th\xe0nh: ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"y"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"x"})]})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"x"})]})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mn,{children:"1"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\frac{\\partial y}{\\partial x} = \\frac{\\partial (f(x) + x)}{\\partial x} = f'(x) + 1"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.2772em",verticalAlign:"-0.345em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.9322em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.4461em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.345em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.355em",verticalAlign:"-0.345em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.01em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.485em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mopen mtight",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"mopen mtight",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"}),(0,i.jsx)(e.span,{className:"mclose mtight",children:")"}),(0,i.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"}),(0,i.jsx)(e.span,{className:"mclose mtight",children:")"})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.345em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0019em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1"})]})]})]})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.em,{children:"Khi \xe1p d\u1ee5ng v\xe0o backprobagation"})," \u0111\u1ec3 t\xednh Gradient truy\u1ec1n v\u1ec1: ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"L"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"s"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"x"})]})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"L"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"s"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"y"})]})]}),(0,i.jsx)(e.mo,{children:"\u22c5"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mn,{mathvariant:"bold",children:"1"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.munder,{accentunder:"true",children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"L"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"s"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"y"})]})]}),(0,i.jsx)(e.mo,{children:"\u22c5"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.mo,{stretchy:"true",children:"\u203e"})]}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsxs)(e.munder,{accentunder:"true",children:[(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"L"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"s"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"y"})]})]}),(0,i.jsx)(e.mo,{stretchy:"true",children:"\u203e"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\frac{\\partial Loss}{\\partial x} = \\frac{\\partial Loss}{\\partial y} \\cdot (f'(x) + \\mathbf{1}) = \\underline{\\frac{\\partial Loss}{\\partial y} \\cdot f'(x)} + \\underline{\\frac{\\partial Loss}{\\partial y}}"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.2251em",verticalAlign:"-0.345em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.8801em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"L"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"oss"})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.345em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.3612em",verticalAlign:"-0.4811em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.8801em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"L"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"oss"})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.4811em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0019em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathbf",children:"1"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.5612em",verticalAlign:"-0.6811em"}}),(0,i.jsx)(e.span,{className:"mord underline",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.8801em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.3589em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"underline-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.8801em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"L"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"oss"})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.4811em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.6811em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.5612em",verticalAlign:"-0.6811em"}}),(0,i.jsx)(e.span,{className:"mord underline",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.8801em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.3589em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"underline-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.8801em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"L"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"oss"})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.4811em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.6811em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["N\u1ebfu ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"f'(x)"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0019em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})})]})," c\xf3 gi\u1ea3m nh\u1ecf bao nhi\xeau th\xec ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"L"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"s"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,i.jsx)(e.mi,{children:"y"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\frac{\\partial Loss}{\\partial y}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.3612em",verticalAlign:"-0.4811em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.8801em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mtight",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"L"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"oss"})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.4811em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})})]})," v\u1eabn gi\xfap ",(0,i.jsx)(e.em,{children:"gradient \u0111\u01b0\u1ee3c truy\u1ec1n ng\u01b0\u1ee3c v\u1ec1 \u0111\u1ea7u"})," m\xe0 kh\xf4ng b\u1ecb ",(0,i.jsx)(e.em,{children:"tri\u1ec7t ti\xeau"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Code \u0111\u01b0\u1ee3c tri\u1ec3n khai t\u1ea1i ph\u1ea7n ",(0,i.jsx)(e.code,{children:"5. Shortcut Connection"})," trong ",(0,i.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/11.%20Placeholder-GPT.ipynb",children:(0,i.jsx)(e.code,{children:"11. Placeholder-GPT.ipynb"})}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"transformer-block",children:"Transformer Block"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Ph\u1ea7n n\xe0y ch\xfang ta s\u1ebd tri\u1ec3n khai \u0111\u1ea7y \u0111\u1ee7 c\xe1c th\xe0nh ph\u1ea7n c\u1ee7a 1 kh\u1ed1i ",(0,i.jsx)(e.em,{children:"Transformer"})," ho\xe0n ch\u1ec9nh. Kh\u1ed1i n\xe0y \u0111\u01b0\u1ee3c l\u1eb7p l\u1ea1i h\xe0ng ch\u1ee5c l\u1ea7n trong ki\u1ebfn tr\xfac ",(0,i.jsx)(e.em,{children:"GPT-2 124M tham s\u1ed1"}),", k\u1ebft h\u1ee3p v\u1edbi nhi\u1ec1u kh\xe1i ni\u1ec7m ch\xfang ta \u0111\xe3 t\xecm hi\u1ec3u tr\u01b0\u1edbc \u0111\xf3: ",(0,i.jsx)(e.code,{children:"multi-head attention"}),", ",(0,i.jsx)(e.code,{children:"layer normalization"}),", ",(0,i.jsx)(e.code,{children:"dropout"}),", ",(0,i.jsx)(e.code,{children:"feed-forward layer"})," & ",(0,i.jsx)(e.code,{children:"GeLU activations"}),". Ph\u1ea7n sau ta s\u1ebd k\u1ebft n\u1ed1i ",(0,i.jsx)(e.em,{children:"kh\u1ed1i Transformer"})," v\u1edbi c\xe1c ph\u1ea7n c\xf2n l\u1ea1i c\u1ee7a ",(0,i.jsx)(e.em,{children:"ki\u1ebfn tr\xfac GPT"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"alt",src:n(7564).A+"",width:"1202",height:"1179"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\xdd t\u01b0\u1edfng c\u1ed1t l\xf5i l\xe0 ",(0,i.jsx)(e.em,{children:"c\u01a1 ch\u1ebf self-attention"})," trong kh\u1ed1i ",(0,i.jsx)(e.em,{children:"multi-head"})," s\u1ebd x\xe1c \u0111\u1ecbnh v\xe0 ph\xe2n t\xedch c\xe1c m\u1ed1i quan h\u1ec7 gi\u1eefa t\u1eebng token \u0111\u1ea7u v\xe0o. Ng\u01b0\u1ee3c l\u1ea1i, ",(0,i.jsx)(e.em,{children:"m\u1ea1ng feed-forward"})," s\u1ebd s\u1eeda l\u1ed7i \u0111\u1ed9c l\u1eadp t\u1eebng v\u1ecb tr\xed."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Code \u0111\u01b0\u1ee3c tri\u1ec3n khai t\u1ea1i ph\u1ea7n ",(0,i.jsx)(e.code,{children:"6. Transformer Block"})," trong ",(0,i.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/11.%20Placeholder-GPT.ipynb",children:(0,i.jsx)(e.code,{children:"11. Placeholder-GPT.ipynb"})}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.em,{children:"LayerNorm"})," \u0111\u01b0\u1ee3c \xe1p d\u1ee5ng tr\u01b0\u1edbc ",(0,i.jsx)(e.em,{children:"MultiHeadAttention"})," & m\u1ea1ng ",(0,i.jsx)(e.em,{children:"FeedForward"}),", v\xe0 ",(0,i.jsx)(e.em,{children:"Dropout"})," \u0111\u01b0\u1ee3c \xe1p d\u1ee5ng sau \u0111\u1ec3 \u0111i\u1ec1u ti\u1ebft m\xf4 h\xecnh v\xe0 ng\u0103n ch\u1eb7n ",(0,i.jsx)(e.em,{children:"overfitting"}),". C\u1ea5u tr\xfac n\xe0y \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ",(0,i.jsx)(e.code,{children:"Pre-LayerNorm"}),", c\xe1c ki\u1ebfn tr\xfac c\u0169 h\u01a1n nh\u01b0 Transformer nguy\xean b\u1ea3n \xe1p d\u1ee5ng ",(0,i.jsx)(e.em,{children:"chu\u1ea9n h\xf3a"})," sau m\u1ea1ng self-attention & feed-forward, \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ",(0,i.jsx)(e.code,{children:"Post-LayerNorm"})," - th\u01b0\u1eddng d\u1eabn \u0111\u1ebfn \u0111\u1ed9ng l\u1ef1c hu\u1ea5n luy\u1ec7n (",(0,i.jsx)(e.em,{children:"training dynamics"}),") k\xe9m h\u01a1n."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Vi\u1ec7c k\xedch th\u01b0\u1edbc vector \u0111\u01b0\u1ee3c gi\u1eef nguy\xean khi \u0111i qua ",(0,i.jsx)(e.em,{children:"kh\u1ed1i Transformer"})," l\xe0 thi\u1ebft k\u1ebf cho ph\xe9p \u1ee9ng d\u1ee5ng hi\u1ec7u qu\u1ea3 tr\xean ph\u1ea1m vi r\u1ed9ng c\xe1c t\xe1c v\u1ee5 chu\u1ed7i sang chu\u1ed7i ",(0,i.jsx)(e.em,{children:"(Sequence-to-Sequence)"}),", n\u01a1i m\u1ed7i vector \u0111\u1ea7u ra t\u01b0\u01a1ng \u1ee9ng tr\u1ef1c ti\u1ebfp v\u1edbi vector \u0111\u1ea7u v\xe0o, duy tr\xec quan h\u1ec7 1-1, \u0111\u1ed3ng th\u1eddi t\xedch h\u1ee3p th\xf4ng tin ng\u1eef c\u1ea3nh t\u1eeb kh\u1eafp to\xe0n b\u1ed9 chu\u1ed7i input ban \u0111\u1ea7u."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"gpt-model",children:"GPT model"})]})}function d(s={}){const{wrapper:e}={...(0,l.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(m,{...s})}):m(s)}},4499:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/attention_22_ffn-cffc62acb368c0f500f2dea6de75f4a7.png"},6270:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/llm-01-overall-9f1a2afeabbd3dd399cb799f9ec12340.png"},1319:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/llm-02-backbone-94bbd0e89891c8135cd9d125e80475a3.png"},2368:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/llm-03-layer-normalization-e53a3b19c6f8b2711e0e1a0733f025d7.png"},9074:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/llm-04-mean-dimension-b5bb8156ae979990ecee13efac25605d.png"},3126:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/llm-05-layernorm-finish-f8b352c7b528ce5c9f626aaaa4eca672.png"},4937:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/shortcut_connections-46bef8dd65d1bc3692abe4f93b4658c2.png"},7564:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/transformer-block-6869be7a75ad2ed91e2e1974b630b7db.png"},2467:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/vanishing_gradient-d4775d5ace629be3ad1ecad8965f7678.png"},8453:(s,e,n)=>{n.d(e,{R:()=>c,x:()=>t});var a=n(6540);const i={},l=a.createContext(i);function c(s){const e=a.useContext(l);return a.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function t(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:c(s.components),a.createElement(l.Provider,{value:e},s.children)}}}]);