"use strict";(self.webpackChunktyan_blog=self.webpackChunktyan_blog||[]).push([[422],{9276:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>h,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>t,toc:()=>s});const t=JSON.parse('{"id":"build-llm-from-scratch/llm-architecture-01","title":"4. LLM Architecture (Part 01)","description":"4.1. Code LLM architecture","source":"@site/docs/build-llm-from-scratch/4. llm-architecture-01.md","sourceDirName":"build-llm-from-scratch","slug":"/build-llm-from-scratch/llm-architecture-01","permalink":"/tyan-blog/docs/build-llm-from-scratch/llm-architecture-01","draft":false,"unlisted":false,"editUrl":"https://github.com/tyanfarm/tyan-blog/tree/main/docs/build-llm-from-scratch/4. llm-architecture-01.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"4. LLM Architecture (Part 01)"},"sidebar":"tutorialSidebar","previous":{"title":"3. Coding Attention Mechanisms (Part 05)","permalink":"/tyan-blog/docs/build-llm-from-scratch/attention-mechanisms-05"},"next":{"title":"Normalization","permalink":"/tyan-blog/docs/build-llm-from-scratch/bonus-section/normalization"}}');var c=i(4848),r=i(8453);const l={sidebar_position:8,title:"4. LLM Architecture (Part 01)"},a=void 0,h={},s=[{value:"4.1. Code LLM architecture",id:"41-code-llm-architecture",level:2},{value:"GPT Backbone",id:"gpt-backbone",level:3},{value:"Layer Normalization",id:"layer-normalization",level:3}];function o(n){const e={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",ul:"ul",...(0,r.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h2,{id:"41-code-llm-architecture",children:"4.1. Code LLM architecture"}),"\n",(0,c.jsx)(e.h3,{id:"gpt-backbone",children:"GPT Backbone"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"C\xe1c m\xf4 h\xecnh Ng\xf4n ng\u1eef l\u1edbn (LLM) nh\u01b0 GPT (Generative Pretrained Transformer) l\xe0 nh\u1eefng ki\u1ebfn tr\xfac m\u1ea1ng n\u01a1-ron c\xf3 k\xedch th\u01b0\u1edbc kh\u1ed5ng l\u1ed3."}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"Tuy nhi\xean, ki\u1ebfn tr\xfac c\u1ee7a m\xf4 h\xecnh n\xe0y th\u1ef1c ch\u1ea5t l\u1ea1i \xedt ph\u1ee9c t\u1ea1p h\u01a1n b\u1ea1n t\u01b0\u1edfng, b\u1edfi nhi\u1ec1u th\xe0nh ph\u1ea7n b\xean trong \u0111\u01b0\u1ee3c l\u1eb7p \u0111i l\u1eb7p l\u1ea1i (ch\xfang ta s\u1ebd t\xecm hi\u1ec3u sau)."}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:i(6270).A+"",width:"896",height:"718"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Ph\xeda tr\xean l\xe0 h\xecnh m\xf4 t\u1ea3 t\u1ed5ng qu\xe1t v\u1ec1 ",(0,c.jsx)(e.em,{children:"1 m\xf4 h\xecnh GPT"}),". B\xean c\u1ea1nh c\xe1c ",(0,c.jsx)(e.code,{children:"embedding layers"})," & ",(0,c.jsx)(e.code,{children:"inputs tokenization"}),", n\xf3 bao g\u1ed3m ",(0,c.jsx)(e.em,{children:"1 ho\u1eb7c nhi\u1ec1u"})," kh\u1ed1i ",(0,c.jsx)(e.code,{children:"Transformer"})," ch\u1ee9a module ",(0,c.jsx)(e.code,{children:"masked multi-head attention"})," (\u0111\xe3 tri\u1ec3n khai \u1edf ch\u01b0\u01a1ng tr\u01b0\u1edbc)."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Tr\u1ecdng t\xe2m \u1edf ch\u01b0\u01a1ng n\xe0y s\u1ebd tri\u1ec3n khai ",(0,c.jsx)(e.em,{children:"core"})," c\u1ee7a LLM, bao g\u1ed3m c\xe1c ",(0,c.jsx)(e.em,{children:"kh\u1ed1i transformer"}),", sau \u0111\xf3 ch\xfang ta s\u1ebd ",(0,c.jsx)(e.em,{children:"hu\u1ea5n luy\u1ec7n"})," \u1edf ch\u01b0\u01a1ng ti\u1ebfp theo \u0111\u1ec3 t\u1ea1o ra v\u0103n b\u1ea3n gi\u1ed1ng con ng\u01b0\u1eddi."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"D\u01b0\u1edbi \u0111\xe2y l\xe0 m\xf4 t\u1ea3 c\xe1c b\u01b0\u1edbc \u0111\u1ec3 build 1 m\xf4 h\xecnh GPT ho\xe0n ch\u1ec9nh."}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"alt",src:i(1319).A+"",width:"1068",height:"449"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["B\u1eaft \u0111\u1ea7u v\u1edbi b\u01b0\u1edbc \u0111\u1ea7u ti\xean l\xe0 x\xe2y d\u1ef1ng ",(0,c.jsx)(e.code,{children:"GPT Backbone"}),", ta s\u1ebd tri\u1ec3n khai 1 class l\xe0 ",(0,c.jsx)(e.code,{children:"DummyGPTModel"})," - phi\xean b\u1ea3n \u0111\u01a1n gi\u1ea3n h\xf3a c\u1ee7a m\xf4 h\xecnh GPT, s\u1eed d\u1ee5ng module neural network c\u1ee7a Pytorch ",(0,c.jsx)(e.em,{children:"nn.Module"}),". Ki\u1ebfn tr\xfac c\u1ee7a m\xf4 h\xecnh \u0111\u01b0\u1ee3c tri\u1ec3n khai t\u1ea1i ph\u1ea7n ",(0,c.jsx)(e.code,{children:"1. GPT Backbone"})," trong ",(0,c.jsx)(e.a,{href:"https://github.com/tyanfarm/build-LLM-from-scratch-notebook/blob/main/11.%20Placeholder-GPT.ipynb",children:(0,c.jsx)(e.code,{children:"11. Placeholder-GPT.ipynb"})}),"."]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h3,{id:"layer-normalization",children:"Layer Normalization"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Vi\u1ec7c hu\u1ea5n luy\u1ec7n ",(0,c.jsx)(e.code,{children:"deep neural network"})," (m\u1ea1ng n\u01a1-ron s\xe2u) v\u1edbi nhi\u1ec1u t\u1ea7ng ",(0,c.jsx)(e.code,{children:"hidden layer"})," d\u1ec5 g\u1eb7p v\u1ea5n \u0111\u1ec1 nh\u01b0 ",(0,c.jsx)(e.em,{children:"vanishing gradient (tri\u1ec7t ti\xeau \u0111\u1ea1o h\xe0m)"})," hay ",(0,c.jsx)(e.em,{children:"exploding gradient (b\xf9ng n\u1ed5 \u0111\u1ea1o h\xe0m)"}),". \u0110i\u1ec1u n\xe0y c\xf3 ngh\u0129a m\xf4 h\xecnh s\u1ebd g\u1eb7p kh\xf3 kh\u0103n trong vi\u1ec7c t\xecm ra b\u1ed9 tham s\u1ed1 t\u1ed1i \u01b0u \u0111\u1ec3 gi\u1ea3m ",(0,c.jsx)(e.em,{children:"loss"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Ph\u1ea7n n\xe0y ch\xfang ta s\u1ebd tri\u1ec3n khai ",(0,c.jsx)(e.code,{children:"layer normalization"}),". \xdd t\u01b0\u1edfng ch\xednh l\xe0 \u0111i\u1ec1u ch\u1ec9nh c\xe1c gi\xe1 tr\u1ecb ",(0,c.jsx)(e.code,{children:"activations"})," c\u1ee7a 1 ",(0,c.jsx)(e.em,{children:"hidden layer"})," sao cho ch\xfang c\xf3 ",(0,c.jsxs)(e.em,{children:["gi\xe1 tr\u1ecb trung b\xecnh (",(0,c.jsx)(e.a,{href:"/tyan-blog/docs/machine-learning/base-math/probability-statistics",children:"mean"}),")"]})," b\u1eb1ng 0 v\xe0 ",(0,c.jsxs)(e.em,{children:["ph\u01b0\u01a1ng sai (",(0,c.jsx)(e.a,{href:"/tyan-blog/docs/machine-learning/base-math/probability-statistics",children:"variance"}),")"]})," b\u1eb1ng 1 - vi\u1ec7c \u0111i\u1ec1u ch\u1ec9nh ",(0,c.jsx)(e.em,{children:"mean"})," & ",(0,c.jsx)(e.em,{children:"variance"})," n\xe0y l\xe0 c\u1ee7a ",(0,c.jsx)(e.a,{href:"/tyan-blog/docs/build-llm-from-scratch/bonus-section/normalization",children:"Standardization"}),". \u0110\u1ec3 \xfd th\xeam 1 \u0111i\u1ec1u l\xe0 t\u1ea1i sao l\u1ea1i chu\u1ea9n h\xf3a theo 2 gi\xe1 tr\u1ecb n\xe0y, th\xec b\u1edfi v\xec ",(0,c.jsx)(e.a,{href:"/tyan-blog/docs/machine-learning/base-math/probability-statistics",children:"Ph\xe2n ph\u1ed1i chu\u1ea9n"})," d\u1ef1a tr\xean 2 tham s\u1ed1 n\xe0y."]}),"\n"]}),"\n"]})]})}function d(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(o,{...n})}):o(n)}},6270:(n,e,i)=>{i.d(e,{A:()=>t});const t=i.p+"assets/images/llm-01-overall-9f1a2afeabbd3dd399cb799f9ec12340.png"},1319:(n,e,i)=>{i.d(e,{A:()=>t});const t=i.p+"assets/images/llm-02-backbone-94bbd0e89891c8135cd9d125e80475a3.png"},8453:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>a});var t=i(6540);const c={},r=t.createContext(c);function l(n){const e=t.useContext(r);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:l(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);